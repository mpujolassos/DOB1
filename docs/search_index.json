[["index.html", "Pràctiques per l’anàlisi de dades òmiques amb R Dades Òmiques i Bioinformàtica I - 2n curs Biomedicina (UVic - UCC) Presentació del curs Estructura del llibre i els seus continguts Desenvolupament de les pràctiques Requisits Crèdits", " Pràctiques per l’anàlisi de dades òmiques amb R Dades Òmiques i Bioinformàtica I - 2n curs Biomedicina (UVic - UCC) Meritxell Pujolassos Tanyà 2026 Presentació del curs Aquest llibre recull les pràctiques del curs d’Anàlisi de Dades i Bioinformàtica I, pensades perquè l’estudiant es familiaritzi amb l’entorn d’R, la manipulació de dades, l’estadística bàsica i la generació d’informes reproduïbles. L’objectiu d’aquest material és proporcionar les eines bàsiques per: Importar i exportar dades a R Manipular, filtrar i seleccionar grans volums de dades Entendre i saber aplicar els principals anàlisis estadístics en cada cas Visualitzar els resultats amb els gràfic adients per cada tipologia de dades Comunicar els resultats de manera reproduïble Estructura del llibre i els seus continguts Cada pràctica és un capítol independent en el qual es treballen els continguts de l’assignatura de Dades Òmiques i Bioinformàtica I de 2n curs de Biomedicina de la Universitat de Vic - Universitat central de Catalunya (Pla de treball de l’assignatura): Tema 1. Introducció al món de les dades òmiques: Pràctica 1 i Pràctica 2 Tema 2. Anàlisi de Variança: Pràctica 3 i Pràctica 4 Tema 3. Estadística no paramètrica: Pràctica 5 i Pràctica 6 Tema 4. Models de regressió: Pràctica 7, Pràctica 8, Pràctica 9, Pràctica 10 Tema 5. Visualització de dades Òmiques: Pràctica 11 Desenvolupament de les pràctiques Durant la pràctica Caldrà seguir la pràctica i realitzar un RMarkdown amb tots els passos seguits. A l’aula virtual de l’assignatura trobaràs un qüestionari associat a cada pràctica. Cal respondre’l abans de la data límit de tancament i escriure el codi al mateix document RMarkdown de la pràctica. Al finalitzar la pràctica Caldrà entregar el document lliurable (.html) amb el codi seguit durant la pràctica, i el codi que permet respondre a les preguntes del qüestionari. Requisits R i RStudio instal·lats Coneixements bàsics de biociències i estadística Interès per l’anàlisi de dades i la reproduïbilitat científica Crèdits Material preparat per Meritxell Pujolassos Tanyà, docent al Departament de Biociències de la Universitat de Vic - Universitat Central de Cataluna. Universitat de Vic – Universitat Central de Catalunya Facultat de Ciències, Tecnologia i Enginyeries C/ de la Laura, 13 · 08500 Vic (Barcelona) © 2026 UVic‑UCC · Material docent d’ús exclusivament acadèmic. "],["01-pract1-taller_gust.html", "Pràctica 1. Introducció pràctica a les eines i bases de dades bioinformàtiques Objectius Descripció de la pràctica", " Pràctica 1. Introducció pràctica a les eines i bases de dades bioinformàtiques Objectius Identificar i explorar bases de dades biològiques que proporcionen informació sobre gens, proteïnes i trets o malalties genètiques associades Aprendre a utilitzar eines bioinformàtiques bàsiques per a la consulta i l’anàlisi de dades genètiques Aplicar els coneixements al cas concret del gust amarg, analitzant un gen d’interès (com el TAS2R38, quan s’especifica en contextos relacionats) Descripció de la pràctica La primera pràctica correspon a una de les activitat de divulgació incloses dins del programa Desxifrant Enigma, impulsat pel grup de Recerca Bi-squared (UVic - UCC), que té com a objectiu impulsar la Bioinformàtica. Concretament, seguirem l’activitat anomenada “El Gust per la Bioinformàtica”. "],["02-pract2-dades.html", "Pràctica 2. Obtenció de dades de RNA-seq pel seu anàlisi Objectius 1. Estudi d’RNAseq de pacients amb Tuberculosis 2. Treballar les dades amb R 3. Exportar les dades creades Bibliografia", " Pràctica 2. Obtenció de dades de RNA-seq pel seu anàlisi Objectius En aquesta pràctica es treballaran funcions específiques d’R com: Importar i exportar fitxers a l’R Manipular datasets de grans dimensions (dades RNAseq): filtrar per columnes, filtrar per files, unir datasets, etc. Definir noms de columnes i de files Estructurar un RMarkdown per generar un fitxer .html amb els resultats desitjats A més, la pràctica servirà per introduir-se al context de les dades amb les quals es treballarà durant l’assignatura: Entendre l’estudi d’on provenen les dades Compendre les variables obtingudes Formular possibles preguntes de recerca i hipòtesis científiques 1. Estudi d’RNAseq de pacients amb Tuberculosis 1.1 Contextualització del problema científic En aquestes pràctiques es treballaran dades d’expressió (RNAseq) de pacients amb tuberculosis. Les dades originals s’han extret del treball de Thomson et al. (2017) titulat “Host blood RNA signatures predict the outcome of tuberculosis treatment” [2] Les dades originals es troben emmagatzemades al repositori GEO amb número d’accés GSE89403. Aquesta pàgina conté informació sobre l’estudi, l’obtenció de les dades i els fitxers amb les dades. El primer que cal fer és contextualitzar l’objecte d’estudi: Tasca Accedeix a GEO i busca la fitxa de l’estudi (GSE89403) Llegeix el resum de la fitxa GEO i fes un esquema del disseny de l’experiment. Hi ha rèpliques biològiques? i tècniques? Quina és la diferència entre aquestes dues? Busca a la fitxa de GEO la plataforma òmica que han utilitzat per fer l’anàlisi. 1.2. Descarregar dades Les dades de RNAseq generen una gran quantitat de variables! Per tal de facilitar i agilitzar els anàlisi nosaltres treballarem amb unes dades adaptades de les originals. Dins de l’apartat de Pràctiques d’R de l’aula virtual trobaras una carpeta, Dades, amb dos fitxers: practR_metadades.csv Fitxer amb variables mèdiques (covariables) practR_rnadata.csv Fitxer amb les abundàncies (normalitzades) dels gens Tasca Descarrega’t els dos fitxers (descomprimeix la carpeta si es baixa en una carpeta comprimida) i guarda’ls dins la carpeta amb la qual treballaràs. 2. Treballar les dades amb R 2.1. Introducció a l’RMarkdown L’RMarkdown és un format de scripts d’R que permet escriure en un únic fitxer de sortida text, codi i resultats del codi. Aquest fitxer de sortida pot ser en format .html, .pdf o word. En aquesta assignatura es realitzaran totes les pràctiques amb RMarkdown i s’entregarà ja sigui l’RMarkdown com el fitxer de sortida (en format .html). Per generar aquest tipus de fitxer cal obrir un nou fitxer del tipus RMarkdown: File &gt; New File &gt; RMarkdown. Automàticament s’obre una finestra demanant que s’introdueixi títol, autor i data. Aquests camps es podran modificar un cop creat el fitxer. Un cop creat el fitxer es recomana guardar-lo a la mateixa carpeta on hi haurà les dades que es treballaran: File &gt; Save As... &gt; Nom_del_fitxer (format .Rmd) Esctructura de R Markdown Encapçalament: porta la informació tant del títol i autor del document, com també del format de “output” (de sortia). Per defecte deixarem output: html_document Text: quan s’escriu directament al document apareixarà com a text Codi: el codi d’R s’ha d’escriure dins dels “chunks”. Qualsevol cosa que introduim dins del chunk és com si ho fessim en un script d’R. El resultat (output) del codi també apareix directament a sota del chunk: # Això és un chunck i s&#39;ha d&#39;escriure com si escribissim en un script d&#39;R # qualsevol text que volguem comentar aquí dins ha de començar per # summary(cars) # el codi s&#39;escriu com en un script d&#39;R i el resultat d&#39;aquest apareix just a sota ## speed dist ## Min. : 4.0 Min. : 2.00 ## 1st Qu.:12.0 1st Qu.: 26.00 ## Median :15.0 Median : 36.00 ## Mean :15.4 Mean : 42.98 ## 3rd Qu.:19.0 3rd Qu.: 56.00 ## Max. :25.0 Max. :120.00 Per inserir un chunk cal: Code &gt; Insert Chunk. O bé Ctrl+Alt+I Nota: Si vols més informació sobre RMarkdown pots consultar el llibre online “R Markdown Cookbook”[1]. Amb això ara ja podem començar a treballar les dades! Tasca Crea un nou RMarkdown i guarda’l amb el nom de Practica2. Aquest serà el fitxer que contindrà el codi i els comentaris d’aquesta primera pràctica. 2.2. Importar dades a R Un cop creat el nou RMarkdown, pots eliminar tots els chunks excepte el primer. Ara ja tens el fitxer a punt per començar a treballar. Crea un nou chunk i defineix el teu directori de treball (sí, és obligatori!). Hauria de ser una cosa similar a: setwd(path/to/your/folder/with/data) Importa les dades. Fixa’t en el format dels dos fitxer. Fes servir la següent funció: # carregar dades metadata &lt;- read.csv2(&quot;dades/practR_metadades.csv&quot;, dec = &quot;,&quot;) data_raw &lt;- read.csv2(&quot;dades/practR_rnadata.csv&quot;, dec = &quot;,&quot;) Nota: quan segueixis un tutorial és molt important mantenir els noms dels objecte per evitar error inecessaris 2.3. Anàlisi exploratori de la metadada És molt important conèixer quines mostres estem analitzant, quins grups hi ha, dimensions i característiques d’aquests grups abans de començar a analitzar les dades. Quina estuctura té el dataset metadata? Les variables són les columnes o les files? str(metadata) ## &#39;data.frame&#39;: 360 obs. of 7 variables: ## $ X : chr &quot;mostra1&quot; &quot;mostra2&quot; &quot;mostra3&quot; &quot;mostra4&quot; ... ## $ Tractament: chr &quot;control&quot; &quot;control&quot; &quot;control&quot; &quot;control&quot; ... ## $ Temps : int 0 1 4 24 0 1 4 24 0 1 ... ## $ Individu : int 1 1 1 1 2 2 2 2 3 3 ... ## $ Edat : int 50 50 50 50 34 34 34 34 70 70 ... ## $ Sexe : chr &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; ... ## $ Xpert : num 2.88 7.88 4.09 8.83 9.4 ... Quines dimensions té metadata (nombre de files i columnes)? dim(metadata) ## [1] 360 7 Imprimeix el nom de les variables colnames(metadata) # Nom de les variables ## [1] &quot;X&quot; &quot;Tractament&quot; &quot;Temps&quot; &quot;Individu&quot; &quot;Edat&quot; ## [6] &quot;Sexe&quot; &quot;Xpert&quot; Tenen el nom correcte les files? Quin hauria de ser el nom de les files? rownames(metadata) [1:10] ## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot; &quot;10&quot; Perquè serveix afegir [1:10] al codi anterior? Defineix el nom de les files amb el respectiu nom de la mostra. Primer has de trobar a quina columna estan definits el nom de les mostres: metadata$X[1:10] # columna que conté el nom de les mostres ## [1] &quot;mostra1&quot; &quot;mostra2&quot; &quot;mostra3&quot; &quot;mostra4&quot; &quot;mostra5&quot; &quot;mostra6&quot; ## [7] &quot;mostra7&quot; &quot;mostra8&quot; &quot;mostra9&quot; &quot;mostra10&quot; rownames(metadata) &lt;- metadata$X # definim el nom de les files (mostres) metadata &lt;- metadata[,-1] #eliminem columnes inecessàries Converteix a factor les variables Tractament, Temps, Individu i Sexe. metadata$Individu &lt;- factor(metadata$Individu) metadata$Temps &lt;- factor(metadata$Temps, levels = c(0, 1, 4, 24), labels = c(&quot;basal&quot;, &quot;1set&quot;, &quot;4set&quot;, &quot;24set&quot;)) metadata$Sexe &lt;- factor(metadata$Sexe) Comprova que l’estructura de metadata sigui correcte ara. Descriu les diferents categories de cada factor (Tractament, Temps, Individu i Sexe). Canvia l’ordre de les categories del factor Sexe (primer M i després F). Després de canviar l’ordre, la funció table() ens permet visualitzar l’ordre de les categories. Això és molt útil per quan volem visualitzar la variable. table(metadata$Sexe) # ordre predeterminat (normalment ordre alfabètic) ## ## F M ## 196 164 metadata$Sexe &lt;- factor(metadata$Sexe, levels = c(&quot;M&quot;, &quot;F&quot;)) # mitjançant &quot;levels&quot; definim l&#39;odre de les categories table(metadata$Sexe) # comprovem si s&#39;ha guardat l&#39;ordre correcte ## ## M F ## 164 196 Quan visualitzem la taula amb un gràfic de barres, l’odre de les etiquetes correspon a l’ordre de les columnes: barplot(table(metadata$Sex)) Tasca Torna a canviar l’ordre (primer F i després M) i representa-ho amb un gràfic de barres. a) Anàlisi descriptiu univariant Variables Numèriques Primer farem un anàlisi descriptiu (gràfic i numèric) de les variables numèriques. Quines són les variables numèriques dins de metadata? Defineix-les. Si cal, busca informació adicional per entendre de quines variables es tracta. Fes un resum numèric de la variable Edat. summary(metadata$Edat) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 22.00 34.00 48.00 49.38 62.00 79.00 Fes un gràfic per resumir la variable Edat. Quin gràfic genera la funció hist()? hist(metadata$Edat) Tasca Fes un resum numèric i un gràfic de la variable Xpert Variables Categòriques Tasca Resumeix numèricament (taula de freqüències) i gràficament (gràfic de barres) cada una de les variables categòriques per separat: Sexe i Tractament b) Anàlisi descriptiu bivariant Podria ser que algunes d’aquestes variables estiguessin relacionades. Ara explora la relació entre elles. Concretament, descriu la relació del Tractament amb Sexe numèricament. Fes també un gràfic per visualitzar la relació. Descriu la relació del Tractament amb Edat amb un gràfic. Descriu la relació del Tractament amb Xpert amb un gràfic. Calcula també els estadístics descriptius més interessants (numèric). Escriu una petita conclusió dels resultats de l’anàlisi exploratòria (uni i bivariant) 2.4. Anàlisi exploratori de les abundàncies gèniques Ara comencem a analitzar la taula d’abundàncies dels gens seqüenciats (data_raw). Quina és l’estructura del dataset data_raw. Quants gens hi ha? Totes les columnes de data_raw corresponen a un gen? a) Posada a punt de la taula d’abundàncies Extreu el nom de les mostres. Crea una còpia del dataset (anomenat data0) i defineix el nom de les files corresponents a cada mostra (pensa en eliminar columnes inecessàries al final). Imprimeix (visualitza) les abundàncies dels 7 primers gens en les 5 primeres mostres (de l’objecte data0) Extreu el nom dels gens i guarda’ls en un vector que anomenaràs gene_names. Mostra el nom del gen 23, 24 i 38 (fes-ho amb una única línia de codi). gene_names &lt;- colnames(data0) Pots comprovar si tots els gens són presents a totes les mostres? Hi ha algun gen que no s’hagi detectat a cap mostra? # Detectem els gens que no estiguin presents a cap mostra zero_rm &lt;- which(colSums(data0) == 0) length(zero_rm) # quants n&#39;hi ha? ## [1] 3 Elimina aquells gens que no hagin set detectats en cap mostra. Per fer-ho crea un nou dataset anomenat data sense les columnes identificades al codi anterior (dins del vector zero_rm). b) Explorar la distribució de les abundàncies A partir d’ara ja podem treballar amb el dataset data. Hem vist que la majoria de gens (variables) d’RNAseq tenen una distribució amb una cua a la dreta. Visualitza la distribució del Gen_1 (tingues en compte quin tipus de variable és i, per tant, quin gràfic representa millor la seva distribució). Et sembla que té una distribució normal? Realitza un test estadístic per comprovar si realment té o no una distribució normal. Explica el resultat del test Pots extreure’n només el p.value? shapiro.test(data$Gen_1)$p.value ## [1] 5.235803e-21 Tasca Visualitza la distribució del Gen 15 i comprova si segueix una distribució normal. Ara crearem una funció per comprovar la normalitat de tots els gens del dataset. Ho farem amb la funció apply de la següent manera: # Normalitat de tots els gens (funció apply) normality.test&lt;-apply(data, 2, function(x) shapiro.test(x)$p.value) head(normality.test) ## Gen_1 Gen_2 Gen_3 Gen_4 Gen_5 Gen_6 ## 5.235803e-21 1.720053e-19 5.303406e-01 1.126407e-06 8.471637e-22 7.856582e-09 Tasca Explica amb les teves paraules els arguments de dins la funció apply (pots ajudar-te del “help”) Quants gens segueixen una distribució normal (defineix el llindar de significació a 0.05)? 3. Exportar les dades creades Arribats en aquest punt, necessitem guardar el nou dataset data el qual hem filtrat aquells absents a totes les mostres. Pots exportar el dataset en forma de fitxer de test .csv de la següent manera: write.csv2(data, &quot;practR_rnadata_filt.csv&quot;) Bibliografia Yihui Xie, Christophe Dervieux, Emily Riederer (2024) R Markdown Cookbook. Online version from https://bookdown.org/yihui/rmarkdown-cookbook/ Ethan G. Thompson, et al. (2017) Host blood RNA signatures predict the outcome of tuberculosis treatment, Tuberculosis, Volume 107 (48-58) ISSN 1472-9792 https://doi.org/10.1016/j.tube.2017.08.004. "],["03-pract3-anovaI.html", "Pràctica 3. Testos d’igualtat de mitjanes per dues o més poblacions: T-test i ANOVA Objectius de la pràctica 1. Importar dades a R 2. Selecció d’un subconjunt de dades 3. Comparació de l’expressió entre dues poblacions 4. Comparació de l’expressió entre més de dues poblacions", " Pràctica 3. Testos d’igualtat de mitjanes per dues o més poblacions: T-test i ANOVA Objectius de la pràctica Els objectius principals de la pràctica són: Manipulació de data.frames (combinar data.frames, filtrar files, seleccionar columnes…) Aplicar testos de comparació de mitjanes (t test o ANOVA) Comprovar els supòsits de normalitat i homocedasticitat Compendre les hipòtesis estadístiques associades a aquests testos i prendre desicions a partir dels seus resultats Visualitzar de manera adequada les dades Relacionar les hipòtesis científiques plantejades inicialment amb els resultats estadístics 1. Importar dades a R Tasca Crea un nou RMarkdown anomenat “Practica3” i guarda’l a la carpeta de Pràctiques. Crea un nou chunk que inclogui les diferents llibreries que utilitzarem durant la pràctica: library(ggpubr) library(car) En un altre chunk defineix el teu directori de treball setwd(&quot;path/to/your/folder/with/data&quot;) Carrega les dades. A partir d’ara treballaràs amb el fitxer d’abundàncies filtrat a la pràctica anterior (fitxer d’abundàncies de gens: “practR_rnadata_filt.csv” i fitxer de metadades: “practR_metadades.csv”) # carregar dades metadata &lt;- read.csv2(&quot;dades/practR_metadades.csv&quot;, dec = &quot;,&quot;, row.names = 1) data &lt;- read.csv2(&quot;dades/practR_rnadata_filt.csv&quot;, dec = &quot;,&quot;, row.names = 1) *Nota: Fixa’t que si importes les dades amb l’argument row.names = 1, automàticament es llegeix la primer columna com a noms de les files. Comprova que hi ha els mateixos noms de les files en els dos datasets (metadata i data) # comprovem que els dos datasets tenen el mateix ordre de files (mostres) all(rownames(data) == rownames(metadata)) ## [1] TRUE Combina les dues matrius de dades en un sol data.frame (l’anomenarem df): # combinem els dos datasets en un de sol df &lt;- cbind(metadata, data) Fes les transformacions necessàries: # transformem a factor df$Individu &lt;- factor(df$Individu) df$Temps &lt;- factor(df$Temps, levels = c(0, 1, 4, 24), labels = c(&quot;basal&quot;, &quot;1set&quot;, &quot;4set&quot;, &quot;24set&quot;)) df$Sexe &lt;- factor(df$Sexe) Ara ja tenim les dades a punt, podem començar els anàlisis 2. Selecció d’un subconjunt de dades En aquesta pràctica analitzarem l’expressió d’alguns gens a temps basal (recorda que a l’estudi hi ha mostres a temps basal, però també a 1, 4 i 24 setmanes després d’iniciar el tractament). Selecciona només les mostres preses a temps basal: # definim les files que compleixen els requisits especificats ($Temps == &quot;basal&quot;) ind_basal &lt;- which(df$Temps == &quot;basal&quot;) # seleccionem només aquestes files en un nou data.frame df0 &lt;- df[ind_basal, ] Tasca Comprova que has seleccionat les mostres que tocaven 3. Comparació de l’expressió entre dues poblacions Pregunta de recerca Es vol saber si l’expressió del Gen 32 a temps basal és diferent entre els individus infectats no curats i els individus control Per poder resoldre la pregunta de recerca, caldrà comprovar si hi ha diferències significatives en l’expressió del Gen 32 entre dues poblacions: Controls vs No Curats. Tasca Aquesta comparació ja l’hem estudiat. Quin test haurem d’aplicar? Exploració de les dades Per fer-ho s’han de seleccionar prèviament només aquelles mostres (a temps basal) que pertanyen a individus controls i a individus no curats (els curats els deixem per més endavant). Selecciona a partir de df0 aquelles mostres que són controls o no curats: # definim les files que compleixen els requisits especificats ($Tractament == &quot;control&quot; o bé $Tractament == &quot;no curat&quot;) ind0_ctrl_nc &lt;- which(df0$Tractament == &quot;control&quot; | df0$Tractament == &quot;no curat&quot; ) # el simbol | indica &quot;o bé&quot; # seleccionem les files desitjades del data.frame df0 df0_ctrl_nc &lt;- df0[ind0_ctrl_nc, ] # dataset basal amb controls i no curats head(df0_ctrl_nc) ## Tractament Temps Individu Edat Sexe Xpert Gen_1 Gen_2 Gen_3 Gen_4 ## mostra1 control basal 1 50 F 2.875775 3.64 6.66 45.68 44.66 ## mostra5 control basal 2 34 F 9.404673 17.58 12.05 53.13 42.03 ## mostra9 control basal 3 70 M 5.514350 13.65 30.96 50.67 41.14 ## mostra13 control basal 4 33 M 6.775706 5.82 7.24 54.06 45.41 ## mostra17 control basal 5 22 F 2.460877 12.29 45.76 53.51 42.22 ## mostra21 control basal 6 61 M 8.895393 8.25 2.73 43.74 43.03 ## Gen_5 Gen_6 Gen_8 Gen_9 Gen_10 Gen_11 Gen_12 Gen_13 Gen_14 Gen_15 ## mostra1 9.30 53.37 17.05 8.73 4.73 4.15 15.03 25.74 50.64 33.95 ## mostra5 4.33 66.54 2.18 81.63 41.55 35.28 19.56 18.14 49.72 15.41 ## mostra9 36.46 54.70 31.83 17.84 21.00 73.22 39.46 7.35 54.99 34.55 ## mostra13 29.21 61.21 85.51 13.03 3.36 11.24 28.11 7.04 50.20 9.62 ## mostra17 71.42 66.78 3.17 11.60 3.65 4.79 29.15 36.57 50.62 16.76 ## mostra21 1.98 55.87 8.34 5.42 3.71 37.37 15.80 19.11 50.63 5.73 ## Gen_16 Gen_17 Gen_18 Gen_19 Gen_20 Gen_21 Gen_22 Gen_23 Gen_24 Gen_25 ## mostra1 8.00 40.05 27.62 0.39 8.00 6.58 0.93 50.49 12.93 11.13 ## mostra5 45.35 43.30 31.19 23.72 7.80 15.30 2.93 15.84 4.87 6.40 ## mostra9 1.29 46.96 23.62 16.45 27.52 24.99 13.42 2.72 2.95 14.00 ## mostra13 20.91 37.02 29.90 9.09 51.02 11.79 10.47 88.84 25.75 23.71 ## mostra17 7.86 38.90 28.41 33.68 17.83 8.05 11.10 4.33 27.42 20.34 ## mostra21 42.54 37.44 20.68 20.65 19.00 1.96 2.05 3.98 1.15 9.00 ## Gen_26 Gen_27 Gen_28 Gen_29 Gen_30 Gen_31 Gen_32 Gen_33 Gen_34 Gen_35 ## mostra1 28.56 7.57 2.39 13.39 51.67 42.60 48.44 54.03 23.11 4.54 ## mostra5 14.31 16.20 12.95 30.83 47.35 40.01 52.33 55.33 15.35 100.75 ## mostra9 15.66 5.98 6.24 25.93 46.63 49.47 48.82 50.69 0.57 3.94 ## mostra13 15.39 12.21 28.70 49.87 55.43 46.10 50.90 56.18 8.58 12.31 ## mostra17 3.66 13.23 44.00 1.72 46.37 55.94 59.90 59.78 12.84 13.74 ## mostra21 12.38 21.17 6.11 2.24 46.19 51.12 55.02 57.35 10.50 35.66 ## Gen_36 Gen_37 Gen_38 Gen_39 Gen_40 Gen_41 Gen_42 Gen_43 Gen_44 Gen_45 ## mostra1 41.09 42.88 49.13 39.91 55.79 32.80 51.40 54.35 81.17 50.32 ## mostra5 1.84 4.42 43.50 47.05 4.53 33.50 54.29 64.36 19.94 34.89 ## mostra9 1.67 27.36 40.83 41.17 34.21 5.00 42.97 24.89 18.25 8.24 ## mostra13 13.11 11.06 46.32 41.34 9.53 60.10 38.37 10.24 28.73 35.31 ## mostra17 18.33 33.71 51.84 55.18 7.37 11.63 53.34 27.26 70.77 25.04 ## mostra21 41.55 8.05 55.45 45.63 3.44 34.22 42.25 87.87 6.85 27.10 ## Gen_46 Gen_47 Gen_49 ## mostra1 66.43 65.04 39.56 ## mostra5 80.58 73.52 53.29 ## mostra9 22.35 64.43 7.46 ## mostra13 34.55 76.62 20.85 ## mostra17 26.38 69.54 2.88 ## mostra21 7.75 69.91 0.50 Visualitza l’expressió del Gen 32 en controls i en no curats. Per fer-ho aplica la funció ggboxplot() de la llibreria ggpubr: ggboxplot(data = df0_ctrl_nc, x = &quot;Tractament&quot;, y = &quot;Gen_32&quot;, color = &quot;Tractament&quot;, palette = c(&quot;steelblue1&quot;, &quot;orange&quot;), add = &quot;jitter&quot;) Tasca S’observen diferències aparents entre els dos grups? Descriu les dades i planteja un possible resultat. Anàlisi estadística Per determinar si efectivament hi ha o no diferències significatives entre controls i no curats haurem d’aplicar un test estadístic: T test d’igualtat de mitjanes per mostres independents Les hipòtesis del T test són: \\[H_0: \\mu_{control} = \\mu_{no.curat}\\] \\[H_a: \\mu_{control} \\neq \\mu_{no curat}\\] 1r. Abans d’aplicar el T test cal comprovar els supòsits: Cal comprovar que les dues mostres provenen de poblacions amb distribució normal (es comprova mitjançant el test de shapiro: shapiro.test()). Aplica el test de Shapiro: tapply(df0_ctrl_nc$Gen_32, df0_ctrl_nc$Tractament, shapiro.test) ## $control ## ## Shapiro-Wilk normality test ## ## data: X[[i]] ## W = 0.95291, p-value = 0.2022 ## ## ## $`no curat` ## ## Shapiro-Wilk normality test ## ## data: X[[i]] ## W = 0.98067, p-value = 0.843 Tasca Interpreta el resultat del test estadístic (tingues en compte les hipòtesis estadístiques del test) Cal conèixer si les variàncies dels dos grups són iguals o no (es comprova mitjançant el test F d’igualtat de variàncies: var.test()). Aplica test F d’igualtat de variàncies: var.test(df0_ctrl_nc$Gen_32~df0_ctrl_nc$Tractament) ## ## F test to compare two variances ## ## data: df0_ctrl_nc$Gen_32 by df0_ctrl_nc$Tractament ## F = 1.023, num df = 29, denom df = 29, p-value = 0.9516 ## alternative hypothesis: true ratio of variances is not equal to 1 ## 95 percent confidence interval: ## 0.4869212 2.1493593 ## sample estimates: ## ratio of variances ## 1.023019 Tasca Interpreta el resultat del test estadístic (tingues en compte les hipòtesis estadístiques del test) 2n. En base als resultats dels dos testos anteriors aplica el test de comparació de mitjanes més adient. t.test(df0_ctrl_nc$Gen_32~df0_ctrl_nc$Tractament, var.equal = T) ## ## Two Sample t-test ## ## data: df0_ctrl_nc$Gen_32 by df0_ctrl_nc$Tractament ## t = -4.389, df = 58, p-value = 4.882e-05 ## alternative hypothesis: true difference in means between group control and group no curat is not equal to 0 ## 95 percent confidence interval: ## -7.699751 -2.876249 ## sample estimates: ## mean in group control mean in group no curat ## 55.532 60.820 Tasca Interpreta el resultat del test estadístic (tingues en compte les hipòtesis estadístiques del test) Escriu les conclusions de l’anàlisi: relaciona el resultat del test estadístic amb la pregunta de recerca 4. Comparació de l’expressió entre més de dues poblacions Pregunta de recerca Es vol saber si l’expressió del Gen 32 a temps basal és diferent entre els individus infectats no curats, els curats i els controls Exploració de les dades Tasca Fes un gràfic per representar l’expressió del Gen 32 en els tres grups estudiats. Pensa bé quin és el data.frame que conté els tres grups de Tractament a temps basal (control, curat i no curat). En el gràfic, fes coincidir els mateixos colors de les caixes que en el boxplot anterior. Anàlisi estadística Per determinar si efectivament hi ha o no diferències significatives entre els tres grups haurem d’aplicar un test estadístic: ANOVA Les hipòtesis de l’ANOVA són: \\[H_0: \\mu_{control} = \\mu_{curat} = \\mu_{no.curat}\\] \\[H_a: \\mu_{control} \\neq \\mu_{curat} ; \\mu_{control} \\neq \\mu_{no.curat} ; \\mu_{curat} \\neq \\mu_{no.curat}\\] 1r. Abans d’aplicar l’ANOVA cal comprovar els supòsits: Comprovar que totes mostres provenen de poblacions amb distribució normal (es comprova mitjançant el test de shapiro: shapiro.test()). Aplica el test de Shapiro pels tres grups tapply(df0$Gen_32, df0$Tractament, shapiro.test) ## $control ## ## Shapiro-Wilk normality test ## ## data: X[[i]] ## W = 0.95291, p-value = 0.2022 ## ## ## $curat ## ## Shapiro-Wilk normality test ## ## data: X[[i]] ## W = 0.96415, p-value = 0.3935 ## ## ## $`no curat` ## ## Shapiro-Wilk normality test ## ## data: X[[i]] ## W = 0.98067, p-value = 0.843 Visualitza amb un QQ plot la normalitat de les dades (fes-ho amb la funció ggqqplot()). Les dades (de cada grup) s’ajusten a la línia? ggqqplot(df0, x = &quot;Gen_32&quot;, facet.by = &quot;Tractament&quot;, short.panel.labs = FALSE) Tasca Interpreta el resultat del test estadístic i del gràfic (tingues en compte les hipòtesis estadístiques del test) Conèixer si les variàncies dels tres grups segueixen l’homocedasticitat (es comprova mitjançant el test de Levene: leveneTest()). Per aplicar la funció leveneTest() hauràs de carregar la llibreria car (ho hauries d’haver fet al principi, al primer chunk). leveneTest(df0$Gen_32~df0$Tractament) ## Levene&#39;s Test for Homogeneity of Variance (center = median) ## Df F value Pr(&gt;F) ## group 2 0.8826 0.4174 ## 87 Tasca Interpreta el resultat del test estadístic (tingues en compte les hipòtesis estadístiques del test) Identificar que les dades són independents: en aquest cas, els individus control, no curats i curats són subjectes independents entre ells. 2n. Si es compleixen els tres supòsits es pot aplicar l’ANOVA: # test anova an1 &lt;- aov(df0$Gen_32 ~ df0$Tractament) # resultats de l&#39;anova summary(an1) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## df0$Tractament 2 1297 648.3 24.15 4.54e-09 *** ## Residuals 87 2335 26.8 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Tasca Interpreta el resultat del test estadístic (tingues en compte les hipòtesis estadístiques del test) Una alternativa per comprovar la normalitat de les dades és contrastar si els residus de l’anova segueixen una distribució normal: Comprova la normalitat dels residus de l’anova shapiro.test(an1$residuals) ## ## Shapiro-Wilk normality test ## ## data: an1$residuals ## W = 0.98553, p-value = 0.4208 3r. Només quan l’ANOVA surt significativa (almenys un dels grups és diferent de la resta), aplicarem proves de comparació múltiples per conèixer quin/quins grup/s difereixen entre si. Realitza proves de comparació múltiple (prova post-hoc) per veure quin (o quins) dels grups difereix de la resta. Descriu els resultats i digues quin ajust del p-valor s’ha fet. pairwise.t.test(df0$Gen_32, df0$Tractament) ## ## Pairwise comparisons using t tests with pooled SD ## ## data: df0$Gen_32 and df0$Tractament ## ## control curat ## curat 0.00380 - ## no curat 0.00031 2.1e-09 ## ## P value adjustment method: holm Ara realitza de nou múltiples T-test (pairwise.t.test) canviant l’ajust del p-valor. Comenta els resultats. Fes una altra prova post-hoc amb el test de Tukey (TukeyHSD()). Comenta els resultats. TukeyHSD(an1) ## Tukey multiple comparisons of means ## 95% family-wise confidence level ## ## Fit: aov(formula = df0$Gen_32 ~ df0$Tractament) ## ## $`df0$Tractament` ## diff lwr upr p adj ## curat-control -3.978667 -7.168458 -0.7888752 0.0105154 ## no curat-control 5.288000 2.098209 8.4777915 0.0004566 ## no curat-curat 9.266667 6.076875 12.4564581 0.0000000 Tasca Escriu les conclusions de l’anàlisi: interpreta el resultat del test estadístic i relaciona-ho amb la pregunta de recerca. Ajuda’t del gràfic de caixes del Gen 32 en els tres grups per la interpretació. "],["04-pract4-anovaII.html", "Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides Objectius Descripció de la pràctica", " Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides Objectius Descripció de la pràctica "],["05-pract5-noparamI.html", "Pràctica 5. Estadística no paramètrica (I): Test de Wilcoxon Objectius Descripció de la pràctica", " Pràctica 5. Estadística no paramètrica (I): Test de Wilcoxon Objectius Descripció de la pràctica "],["06-pract6-noparamII.html", "Pràctica 6. Estadística no paramètrica (II): Test de Kruskal-Wallis i proves post-hoc Objectius Descripció de la pràctica", " Pràctica 6. Estadística no paramètrica (II): Test de Kruskal-Wallis i proves post-hoc Objectius Descripció de la pràctica "],["07-pract7-reglinealI.html", "Pràctica 7. Models de Regressió lineal (I) Objectius Descripció de la pràctica", " Pràctica 7. Models de Regressió lineal (I) Objectius Descripció de la pràctica "],["08-pract8-reglinealII.html", "Pràctica 8. Models de Regressió lineal (II) Objectius Descripció de la pràctica", " Pràctica 8. Models de Regressió lineal (II) Objectius Descripció de la pràctica "],["09-pract9-reglogisticaI.html", "Pràctica 9. Models de Regressió logística (I) Objectius Descripció de la pràctica", " Pràctica 9. Models de Regressió logística (I) Objectius Descripció de la pràctica "],["10-pract10-reglogisticaII.html", "Pràctica 10. Models de Regressió logística (II) Objectius Descripció de la pràctica", " Pràctica 10. Models de Regressió logística (II) Objectius Descripció de la pràctica "],["11-pract11-visualitzacio.html", "Pràctica 11. Visualització i interpretació de resultats de seqüenciació Objectius Descripció de la pràctica", " Pràctica 11. Visualització i interpretació de resultats de seqüenciació Objectius Descripció de la pràctica "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
