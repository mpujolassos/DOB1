[["index.html", "Pràctiques per l’anàlisi de dades òmiques amb R Dades Òmiques i Bioinformàtica I - 2n curs Biomedicina (UVic - UCC) Presentació del curs Estructura del llibre i els seus continguts Desenvolupament de les pràctiques Requisits Crèdits", " Pràctiques per l’anàlisi de dades òmiques amb R Dades Òmiques i Bioinformàtica I - 2n curs Biomedicina (UVic - UCC) Meritxell Pujolassos Tanyà 2026 Presentació del curs Aquest llibre recull les pràctiques del curs d’Anàlisi de Dades i Bioinformàtica I, pensades perquè l’estudiant es familiaritzi amb l’entorn d’R, la manipulació de dades, l’estadística bàsica i la generació d’informes reproduïbles. L’objectiu d’aquest material és proporcionar les eines bàsiques per: Importar i exportar dades a R Manipular, filtrar i seleccionar grans volums de dades Entendre i saber aplicar els principals anàlisis estadístics en cada cas Visualitzar els resultats amb els gràfic adients per cada tipologia de dades Comunicar els resultats de manera reproduïble Estructura del llibre i els seus continguts Cada pràctica és un capítol independent en el qual es treballen els continguts de l’assignatura de Dades Òmiques i Bioinformàtica I de 2n curs de Biomedicina de la Universitat de Vic - Universitat central de Catalunya (Pla de treball de l’assignatura): Tema 1. Introducció al món de les dades òmiques: Pràctica 1 i Pràctica 2 Tema 2. Anàlisi de Variança: Pràctica 3 i Pràctica 4 Tema 3. Estadística no paramètrica: Pràctica 5 i Pràctica 6 Tema 4. Models de regressió: Pràctica 7, Pràctica 8, Pràctica 9, Pràctica 10 Tema 5. Visualització de dades Òmiques: Pràctica 11 Desenvolupament de les pràctiques Durant la pràctica Caldrà seguir la pràctica i realitzar un RMarkdown amb tots els passos seguits. A l’aula virtual de l’assignatura trobaràs un qüestionari associat a cada pràctica. Cal respondre’l abans de la data límit de tancament i escriure el codi al mateix document RMarkdown de la pràctica. Al finalitzar la pràctica Caldrà entregar el document lliurable (.html) amb el codi seguit durant la pràctica, i el codi que permet respondre a les preguntes del qüestionari. Requisits R i RStudio instal·lats Coneixements bàsics de biociències i estadística Interès per l’anàlisi de dades i la reproduïbilitat científica Crèdits Material preparat per Meritxell Pujolassos Tanyà, docent al Departament de Biociències de la Universitat de Vic - Universitat Central de Cataluna. Universitat de Vic – Universitat Central de Catalunya Facultat de Ciències, Tecnologia i Enginyeries C/ de la Laura, 13 · 08500 Vic (Barcelona) © 2026 UVic‑UCC · Material docent d’ús exclusivament acadèmic. "],["01-pract1-taller_gust.html", "Pràctica 1. Introducció pràctica a les eines i bases de dades bioinformàtiques Objectius Descripció de la pràctica", " Pràctica 1. Introducció pràctica a les eines i bases de dades bioinformàtiques Objectius Identificar i explorar bases de dades biològiques que proporcionen informació sobre gens, proteïnes i trets o malalties genètiques associades Aprendre a utilitzar eines bioinformàtiques bàsiques per a la consulta i l’anàlisi de dades genètiques Aplicar els coneixements al cas concret del gust amarg, analitzant un gen d’interès (com el TAS2R38, quan s’especifica en contextos relacionats) Descripció de la pràctica La primera pràctica correspon a una de les activitat de divulgació incloses dins del programa Desxifrant Enigma, impulsat pel grup de Recerca Bi-squared (UVic - UCC), que té com a objectiu impulsar la Bioinformàtica. Concretament, seguirem l’activitat anomenada “El Gust per la Bioinformàtica”. "],["02-pract2-dades.html", "Pràctica 2. Obtenció de dades de RNA-seq pel seu anàlisi Objectius 1. Estudi d’RNAseq de pacients amb Tuberculosis 2. Treballar les dades amb R 3. Exportar les dades creades Bibliografia", " Pràctica 2. Obtenció de dades de RNA-seq pel seu anàlisi Objectius En aquesta pràctica es treballaran funcions específiques d’R com: Importar i exportar fitxers a l’R Manipular datasets de grans dimensions (dades RNAseq): filtrar per columnes, filtrar per files, unir datasets, etc. Definir noms de columnes i de files Estructurar un RMarkdown per generar un fitxer .html amb els resultats desitjats A més, la pràctica servirà per introduir-se al context de les dades amb les quals es treballarà durant l’assignatura: Entendre l’estudi d’on provenen les dades Compendre les variables obtingudes Formular possibles preguntes de recerca i hipòtesis científiques 1. Estudi d’RNAseq de pacients amb Tuberculosis 1.1 Contextualització del problema científic En aquestes pràctiques es treballaran dades d’expressió (RNAseq) de pacients amb tuberculosis. Les dades originals s’han extret del treball de Thomson et al. (2017) titulat “Host blood RNA signatures predict the outcome of tuberculosis treatment” [2] Les dades originals es troben emmagatzemades al repositori GEO amb número d’accés GSE89403. Aquesta pàgina conté informació sobre l’estudi, l’obtenció de les dades i els fitxers amb les dades. El primer que cal fer és contextualitzar l’objecte d’estudi: Tasca Accedeix a GEO i busca la fitxa de l’estudi (GSE89403) Llegeix el resum de la fitxa GEO i fes un esquema del disseny de l’experiment. Hi ha rèpliques biològiques? i tècniques? Quina és la diferència entre aquestes dues? Busca a la fitxa de GEO la plataforma òmica que han utilitzat per fer l’anàlisi. 1.2. Descarregar dades Les dades de RNAseq generen una gran quantitat de variables! Per tal de facilitar i agilitzar els anàlisi nosaltres treballarem amb unes dades adaptades de les originals. Dins de l’apartat de Pràctiques d’R de l’aula virtual trobaras una carpeta, Dades, amb dos fitxers: practR_metadades.csv Fitxer amb variables mèdiques (covariables) practR_rnadata.csv Fitxer amb les abundàncies (normalitzades) dels gens Tasca Descarrega’t els dos fitxers (descomprimeix la carpeta si es baixa en una carpeta comprimida) i guarda’ls dins la carpeta amb la qual treballaràs. 2. Treballar les dades amb R 2.1. Introducció a l’RMarkdown L’RMarkdown és un format de scripts d’R que permet escriure en un únic fitxer de sortida text, codi i resultats del codi. Aquest fitxer de sortida pot ser en format .html, .pdf o word. En aquesta assignatura es realitzaran totes les pràctiques amb RMarkdown i s’entregarà ja sigui l’RMarkdown com el fitxer de sortida (en format .html). Per generar aquest tipus de fitxer cal obrir un nou fitxer del tipus RMarkdown: File &gt; New File &gt; RMarkdown. Automàticament s’obre una finestra demanant que s’introdueixi títol, autor i data. Aquests camps es podran modificar un cop creat el fitxer. Un cop creat el fitxer es recomana guardar-lo a la mateixa carpeta on hi haurà les dades que es treballaran: File &gt; Save As... &gt; Nom_del_fitxer (format .Rmd) Esctructura de R Markdown Encapçalament: porta la informació tant del títol i autor del document, com també del format de “output” (de sortia). Per defecte deixarem output: html_document Text: quan s’escriu directament al document apareixarà com a text Codi: el codi d’R s’ha d’escriure dins dels “chunks”. Qualsevol cosa que introduim dins del chunk és com si ho fessim en un script d’R. El resultat (output) del codi també apareix directament a sota del chunk: # Això és un chunck i s&#39;ha d&#39;escriure com si escribissim en un script d&#39;R # qualsevol text que volguem comentar aquí dins ha de començar per # summary(cars) # el codi s&#39;escriu com en un script d&#39;R i el resultat d&#39;aquest apareix just a sota ## speed dist ## Min. : 4.0 Min. : 2.00 ## 1st Qu.:12.0 1st Qu.: 26.00 ## Median :15.0 Median : 36.00 ## Mean :15.4 Mean : 42.98 ## 3rd Qu.:19.0 3rd Qu.: 56.00 ## Max. :25.0 Max. :120.00 Per inserir un chunk cal: Code &gt; Insert Chunk. O bé Ctrl+Alt+I Nota: Si vols més informació sobre RMarkdown pots consultar el llibre online “R Markdown Cookbook”[1]. Amb això ara ja podem començar a treballar les dades! Tasca Crea un nou RMarkdown i guarda’l amb el nom de Practica2. Aquest serà el fitxer que contindrà el codi i els comentaris d’aquesta primera pràctica. 2.2. Importar dades a R Un cop creat el nou RMarkdown, pots eliminar tots els chunks excepte el primer. Ara ja tens el fitxer a punt per començar a treballar. Crea un nou chunk i defineix el teu directori de treball (sí, és obligatori!). Hauria de ser una cosa similar a: setwd(path/to/your/folder/with/data) Importa les dades. Fixa’t en el format dels dos fitxer. Fes servir la següent funció: # carregar dades metadata &lt;- read.csv2(&quot;dades/practR_metadades.csv&quot;, dec = &quot;,&quot;) data_raw &lt;- read.csv2(&quot;dades/practR_rnadata.csv&quot;, dec = &quot;,&quot;) Nota: quan segueixis un tutorial és molt important mantenir els noms dels objecte per evitar error inecessaris 2.3. Anàlisi exploratori de la metadada És molt important conèixer quines mostres estem analitzant, quins grups hi ha, dimensions i característiques d’aquests grups abans de començar a analitzar les dades. Quina estuctura té el dataset metadata? Les variables són les columnes o les files? str(metadata) ## &#39;data.frame&#39;: 360 obs. of 7 variables: ## $ X : chr &quot;mostra1&quot; &quot;mostra2&quot; &quot;mostra3&quot; &quot;mostra4&quot; ... ## $ Tractament: chr &quot;control&quot; &quot;control&quot; &quot;control&quot; &quot;control&quot; ... ## $ Temps : int 0 1 4 24 0 1 4 24 0 1 ... ## $ Individu : int 1 1 1 1 2 2 2 2 3 3 ... ## $ Edat : int 50 50 50 50 34 34 34 34 70 70 ... ## $ Sexe : chr &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; ... ## $ Xpert : num 2.88 7.88 4.09 8.83 9.4 ... Quines dimensions té metadata (nombre de files i columnes)? dim(metadata) ## [1] 360 7 Imprimeix el nom de les variables colnames(metadata) # Nom de les variables ## [1] &quot;X&quot; &quot;Tractament&quot; &quot;Temps&quot; &quot;Individu&quot; &quot;Edat&quot; ## [6] &quot;Sexe&quot; &quot;Xpert&quot; Tenen el nom correcte les files? Quin hauria de ser el nom de les files? rownames(metadata) [1:10] ## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot; &quot;10&quot; Perquè serveix afegir [1:10] al codi anterior? Defineix el nom de les files amb el respectiu nom de la mostra. Primer has de trobar a quina columna estan definits el nom de les mostres: metadata$X[1:10] # columna que conté el nom de les mostres ## [1] &quot;mostra1&quot; &quot;mostra2&quot; &quot;mostra3&quot; &quot;mostra4&quot; &quot;mostra5&quot; &quot;mostra6&quot; ## [7] &quot;mostra7&quot; &quot;mostra8&quot; &quot;mostra9&quot; &quot;mostra10&quot; rownames(metadata) &lt;- metadata$X # definim el nom de les files (mostres) metadata &lt;- metadata[,-1] #eliminem columnes inecessàries Converteix a factor les variables Tractament, Temps, Individu i Sexe. metadata$Individu &lt;- factor(metadata$Individu) metadata$Temps &lt;- factor(metadata$Temps, levels = c(0, 1, 4, 24), labels = c(&quot;basal&quot;, &quot;1set&quot;, &quot;4set&quot;, &quot;24set&quot;)) metadata$Sexe &lt;- factor(metadata$Sexe) Comprova que l’estructura de metadata sigui correcte ara. Descriu les diferents categories de cada factor (Tractament, Temps, Individu i Sexe). Canvia l’ordre de les categories del factor Sexe (primer M i després F). Després de canviar l’ordre, la funció table() ens permet visualitzar l’ordre de les categories. Això és molt útil per quan volem visualitzar la variable. table(metadata$Sexe) # ordre predeterminat (normalment ordre alfabètic) ## ## F M ## 196 164 metadata$Sexe &lt;- factor(metadata$Sexe, levels = c(&quot;M&quot;, &quot;F&quot;)) # mitjançant &quot;levels&quot; definim l&#39;odre de les categories table(metadata$Sexe) # comprovem si s&#39;ha guardat l&#39;ordre correcte ## ## M F ## 164 196 Quan visualitzem la taula amb un gràfic de barres, l’odre de les etiquetes correspon a l’ordre de les columnes: barplot(table(metadata$Sex)) Tasca Torna a canviar l’ordre (primer F i després M) i representa-ho amb un gràfic de barres. a) Anàlisi descriptiu univariant Variables Numèriques Primer farem un anàlisi descriptiu (gràfic i numèric) de les variables numèriques. Quines són les variables numèriques dins de metadata? Defineix-les. Si cal, busca informació adicional per entendre de quines variables es tracta. Fes un resum numèric de la variable Edat. summary(metadata$Edat) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 22.00 34.00 48.00 49.38 62.00 79.00 Fes un gràfic per resumir la variable Edat. Quin gràfic genera la funció hist()? hist(metadata$Edat) Tasca Fes un resum numèric i un gràfic de la variable Xpert Variables Categòriques Tasca Resumeix numèricament (taula de freqüències) i gràficament (gràfic de barres) cada una de les variables categòriques per separat: Sexe i Tractament b) Anàlisi descriptiu bivariant Podria ser que algunes d’aquestes variables estiguessin relacionades. Ara explora la relació entre elles. Concretament, descriu la relació del Tractament amb Sexe numèricament. Fes també un gràfic per visualitzar la relació. Descriu la relació del Tractament amb Edat amb un gràfic. Descriu la relació del Tractament amb Xpert amb un gràfic. Calcula també els estadístics descriptius més interessants (numèric). Escriu una petita conclusió dels resultats de l’anàlisi exploratòria (uni i bivariant) 2.4. Anàlisi exploratori de les abundàncies gèniques Ara comencem a analitzar la taula d’abundàncies dels gens seqüenciats (data_raw). Quina és l’estructura del dataset data_raw. Quants gens hi ha? Totes les columnes de data_raw corresponen a un gen? a) Posada a punt de la taula d’abundàncies Extreu el nom de les mostres. Crea una còpia del dataset (anomenat data0) i defineix el nom de les files corresponents a cada mostra (pensa en eliminar columnes inecessàries al final). Imprimeix (visualitza) les abundàncies dels 7 primers gens en les 5 primeres mostres (de l’objecte data0) Extreu el nom dels gens i guarda’ls en un vector que anomenaràs gene_names. Mostra el nom del gen 23, 24 i 38 (fes-ho amb una única línia de codi). gene_names &lt;- colnames(data0) Pots comprovar si tots els gens són presents a totes les mostres? Hi ha algun gen que no s’hagi detectat a cap mostra? # Detectem els gens que no estiguin presents a cap mostra zero_rm &lt;- which(colSums(data0) == 0) length(zero_rm) # quants n&#39;hi ha? ## [1] 3 Elimina aquells gens que no hagin set detectats en cap mostra. Per fer-ho crea un nou dataset anomenat data sense les columnes identificades al codi anterior (dins del vector zero_rm). b) Explorar la distribució de les abundàncies A partir d’ara ja podem treballar amb el dataset data. Hem vist que la majoria de gens (variables) d’RNAseq tenen una distribució amb una cua a la dreta. Visualitza la distribució del Gen_1 (tingues en compte quin tipus de variable és i, per tant, quin gràfic representa millor la seva distribució). Et sembla que té una distribució normal? Realitza un test estadístic per comprovar si realment té o no una distribució normal. Explica el resultat del test Pots extreure’n només el p.value? shapiro.test(data$Gen_1)$p.value ## [1] 5.235803e-21 Tasca Visualitza la distribució del Gen 15 i comprova si segueix una distribució normal. Ara crearem una funció per comprovar la normalitat de tots els gens del dataset. Ho farem amb la funció apply de la següent manera: # Normalitat de tots els gens (funció apply) normality.test&lt;-apply(data, 2, function(x) shapiro.test(x)$p.value) head(normality.test) ## Gen_1 Gen_2 Gen_3 Gen_4 Gen_5 Gen_6 ## 5.235803e-21 1.720053e-19 5.303406e-01 1.126407e-06 8.471637e-22 7.856582e-09 Tasca Explica amb les teves paraules els arguments de dins la funció apply (pots ajudar-te del “help”) Quants gens segueixen una distribució normal (defineix el llindar de significació a 0.05)? 3. Exportar les dades creades Arribats en aquest punt, necessitem guardar el nou dataset data el qual hem filtrat aquells absents a totes les mostres. Pots exportar el dataset en forma de fitxer de test .csv de la següent manera: write.csv2(data, &quot;practR_rnadata_filt.csv&quot;) Bibliografia Yihui Xie, Christophe Dervieux, Emily Riederer (2024) R Markdown Cookbook. Online version from https://bookdown.org/yihui/rmarkdown-cookbook/ Ethan G. Thompson, et al. (2017) Host blood RNA signatures predict the outcome of tuberculosis treatment, Tuberculosis, Volume 107 (48-58) ISSN 1472-9792 https://doi.org/10.1016/j.tube.2017.08.004. "],["03-pract3-anovaI.html", "Pràctica 3. Testos d’igualtat de mitjanes per dues o més poblacions: T-test i ANOVA Objectius Descripció de la pràctica", " Pràctica 3. Testos d’igualtat de mitjanes per dues o més poblacions: T-test i ANOVA Objectius Descripció de la pràctica "],["04-pract4-anovaII.html", "Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides Objectius Descripció de la pràctica", " Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides Objectius Descripció de la pràctica "],["05-pract5-noparamI.html", "Pràctica 5. Estadística no paramètrica (I): Test de Wilcoxon Objectius Descripció de la pràctica", " Pràctica 5. Estadística no paramètrica (I): Test de Wilcoxon Objectius Descripció de la pràctica "],["06-pract6-noparamII.html", "Pràctica 6. Estadística no paramètrica (II): Test de Kruskal-Wallis i proves post-hoc Objectius Descripció de la pràctica", " Pràctica 6. Estadística no paramètrica (II): Test de Kruskal-Wallis i proves post-hoc Objectius Descripció de la pràctica "],["07-pract7-reglinealI.html", "Pràctica 7. Models de Regressió lineal (I) Objectius Descripció de la pràctica", " Pràctica 7. Models de Regressió lineal (I) Objectius Descripció de la pràctica "],["08-pract8-reglinealII.html", "Pràctica 8. Models de Regressió lineal (II) Objectius Descripció de la pràctica", " Pràctica 8. Models de Regressió lineal (II) Objectius Descripció de la pràctica "],["09-pract9-reglogisticaI.html", "Pràctica 9. Models de Regressió logística (I) Objectius Descripció de la pràctica", " Pràctica 9. Models de Regressió logística (I) Objectius Descripció de la pràctica "],["10-pract10-reglogisticaII.html", "Pràctica 10. Models de Regressió logística (II) Objectius Descripció de la pràctica", " Pràctica 10. Models de Regressió logística (II) Objectius Descripció de la pràctica "],["11-pract11-visualitzacio.html", "Pràctica 11. Visualització i interpretació de resultats de seqüenciació Objectius Descripció de la pràctica", " Pràctica 11. Visualització i interpretació de resultats de seqüenciació Objectius Descripció de la pràctica "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
