<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides | Pràctiques per l’anàlisi de dades òmiques amb R</title>
  <meta name="description" content="Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides | Pràctiques per l’anàlisi de dades òmiques amb R" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides | Pràctiques per l’anàlisi de dades òmiques amb R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides | Pràctiques per l’anàlisi de dades òmiques amb R" />
  
  
  

<meta name="author" content="Meritxell Pujolassos Tanyà" />


<meta name="date" content="2026-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="03-pract3-anovaI.html"/>
<link rel="next" href="05-pract5-noparamI.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Presentació del curs</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-llibre-i-els-seus-continguts"><i class="fa fa-check"></i>Estructura del llibre i els seus continguts</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#desenvolupament-de-les-pràctiques"><i class="fa fa-check"></i>Desenvolupament de les pràctiques</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#requisits"><i class="fa fa-check"></i>Requisits</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#crèdits"><i class="fa fa-check"></i>Crèdits</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="01-pract1-taller_gust.html"><a href="01-pract1-taller_gust.html"><i class="fa fa-check"></i>Pràctica 1. Introducció pràctica a les eines i bases de dades bioinformàtiques</a>
<ul>
<li class="chapter" data-level="" data-path="01-pract1-taller_gust.html"><a href="01-pract1-taller_gust.html#objectius"><i class="fa fa-check"></i>Objectius</a></li>
<li class="chapter" data-level="" data-path="01-pract1-taller_gust.html"><a href="01-pract1-taller_gust.html#descripció-de-la-pràctica"><i class="fa fa-check"></i>Descripció de la pràctica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html"><i class="fa fa-check"></i>Pràctica 2. Obtenció de dades de RNA-seq pel seu anàlisi</a>
<ul>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#objectius-1"><i class="fa fa-check"></i>Objectius</a></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#estudi-drnaseq-de-pacients-amb-tuberculosis"><i class="fa fa-check"></i>1. Estudi d’RNAseq de pacients amb Tuberculosis</a>
<ul>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#contextualització-del-problema-científic"><i class="fa fa-check"></i>1.1 Contextualització del problema científic</a></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#descarregar-dades"><i class="fa fa-check"></i>1.2. Descarregar dades</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#treballar-les-dades-amb-r"><i class="fa fa-check"></i>2. Treballar les dades amb R</a>
<ul>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#introducció-a-lrmarkdown"><i class="fa fa-check"></i>2.1. Introducció a l’RMarkdown</a></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#importar-dades-a-r"><i class="fa fa-check"></i>2.2. Importar dades a R</a></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#anàlisi-exploratori-de-la-metadada"><i class="fa fa-check"></i>2.3. Anàlisi exploratori de la metadada</a></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#anàlisi-exploratori-de-les-abundàncies-gèniques"><i class="fa fa-check"></i>2.4. Anàlisi exploratori de les abundàncies gèniques</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#exportar-les-dades-creades"><i class="fa fa-check"></i>3. Exportar les dades creades</a></li>
<li class="chapter" data-level="" data-path="02-pract2-dades.html"><a href="02-pract2-dades.html#bibliografia"><i class="fa fa-check"></i>Bibliografia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html"><i class="fa fa-check"></i>Pràctica 3. Testos d’igualtat de mitjanes per dues o més poblacions: T-test i ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#objectius-de-la-pràctica"><i class="fa fa-check"></i>Objectius de la pràctica</a></li>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#importar-dades-a-r-1"><i class="fa fa-check"></i>1. Importar dades a R</a></li>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#selecció-dun-subconjunt-de-dades"><i class="fa fa-check"></i>2. Selecció d’un subconjunt de dades</a></li>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#comparació-de-lexpressió-entre-dues-poblacions"><i class="fa fa-check"></i>3. Comparació de l’expressió entre dues poblacions</a>
<ul>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#exploració-de-les-dades"><i class="fa fa-check"></i>Exploració de les dades</a></li>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#anàlisi-estadística"><i class="fa fa-check"></i>Anàlisi estadística</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#comparació-de-lexpressió-entre-més-de-dues-poblacions"><i class="fa fa-check"></i>4. Comparació de l’expressió entre més de dues poblacions</a>
<ul>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#exploració-de-les-dades-1"><i class="fa fa-check"></i>Exploració de les dades</a></li>
<li class="chapter" data-level="" data-path="03-pract3-anovaI.html"><a href="03-pract3-anovaI.html#anàlisi-estadística-1"><i class="fa fa-check"></i>Anàlisi estadística</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html"><i class="fa fa-check"></i>Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides</a>
<ul>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#objectius-de-la-pràctica-1"><i class="fa fa-check"></i>Objectius de la pràctica</a></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#importar-dades-a-r-2"><i class="fa fa-check"></i>1. Importar dades a R</a></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#comparació-de-lexpressió-gènica-en-funció-de-dos-factors"><i class="fa fa-check"></i>2. Comparació de l’expressió gènica en funció de dos factors</a>
<ul>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#selecció-de-mostres-per-lanàlisi"><i class="fa fa-check"></i>2.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#efecte-de-la-resposta-al-tractament-i-del-sexe-sobre-lexpressió-gènica"><i class="fa fa-check"></i>2.2. Efecte de la resposta al tractament i del sexe sobre l’expressió gènica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#comparació-de-lexpressió-al-llarg-del-temps"><i class="fa fa-check"></i>3. Comparació de l’expressió al llarg del temps</a>
<ul>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#selecció-de-mostres-per-lanàlisi-1"><i class="fa fa-check"></i>3.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#expressió-del-gen-38-al-llarg-del-temps"><i class="fa fa-check"></i>3.2. Expressió del gen 38 al llarg del temps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#comparació-de-lexpressió-al-llarg-del-temps-i-en-funció-dun-factor"><i class="fa fa-check"></i>4. Comparació de l’expressió al llarg del temps i en funció d’un factor</a>
<ul>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#selecció-de-mostres-per-lanàlisi-2"><i class="fa fa-check"></i>4.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="04-pract4-anovaII.html"><a href="04-pract4-anovaII.html#expressió-del-gen-38-al-llarg-del-temps-en-curats-i-no-curats"><i class="fa fa-check"></i>4.2. Expressió del gen 38 al llarg del temps en curats i no curats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html"><i class="fa fa-check"></i>Pràctica 5. Estadística no paramètrica (I): Test de Wilcoxon</a>
<ul>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#objectius-de-la-pràctica-2"><i class="fa fa-check"></i>Objectius de la pràctica</a></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#importar-dades-a-r-3"><i class="fa fa-check"></i>1. Importar dades a R</a></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#comparació-de-lexpressió-respecte-un-valor-de-referència"><i class="fa fa-check"></i>2. Comparació de l’expressió respecte un valor de referència</a>
<ul>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#selecció-de-mostres-per-lanàlisi-3"><i class="fa fa-check"></i>2.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#anàlisi-de-lexpressió-del-gen-43-respecte-el-valor-de-referència"><i class="fa fa-check"></i>2.2. Anàlisi de l’expressió del gen 43 respecte el valor de referència</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#comparació-de-lexpressió-gènica-entre-dues-poblacions-dades-no-normals"><i class="fa fa-check"></i>3. Comparació de l’expressió gènica entre dues poblacions (dades no-normals)</a>
<ul>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#selecció-de-mostres-per-lanàlisi-4"><i class="fa fa-check"></i>3.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#anàlisi-de-lexpressió-del-gen-43-entre-controls-i-curats-al-cap-de-4-setmanes"><i class="fa fa-check"></i>3.2. Anàlisi de l’expressió del gen 43 entre controls i curats al cap de 4 setmanes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#comparació-de-lexpressió-en-mostres-aparellades-dades-no-normals"><i class="fa fa-check"></i>4. Comparació de l’expressió en mostres aparellades (dades no normals)</a>
<ul>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#selecció-de-mostres-per-lanàlisi-5"><i class="fa fa-check"></i>4.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="05-pract5-noparamI.html"><a href="05-pract5-noparamI.html#anàlisi-de-lexpressió-en-pacients-curats-durant-la-primera-setmana"><i class="fa fa-check"></i>4.2. Anàlisi de l’expressió en pacients curats durant la primera setmana</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html"><i class="fa fa-check"></i>Pràctica 6. Estadística no paramètrica (II): Test de Kruskal-Wallis i proves post-hoc</a>
<ul>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#objectius-de-la-pràctica-3"><i class="fa fa-check"></i>Objectius de la pràctica</a></li>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#importar-dades-a-r-4"><i class="fa fa-check"></i>1. Importar dades a R</a></li>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#comparació-de-lexpressió-gènica-entre-més-de-dues-mostres"><i class="fa fa-check"></i>2. Comparació de l’expressió gènica entre més de dues mostres</a>
<ul>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#selecció-de-mostres-per-lanàlisi-6"><i class="fa fa-check"></i>2.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#anàlisi-de-lexpressió-entre-curats-no-curats-i-controls"><i class="fa fa-check"></i>2.2. Anàlisi de l’expressió entre curats, no curats i controls</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#comparació-de-lexpressió-gènica-al-llarg-del-temps"><i class="fa fa-check"></i>3. Comparació de l’expressió gènica al llarg del temps</a>
<ul>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#selecció-de-mostres-per-lanàlisi-7"><i class="fa fa-check"></i>3.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="06-pract6-noparamII.html"><a href="06-pract6-noparamII.html#anàlisi-de-lexpressió-gènica-en-individus-curats-al-llarg-del-temps"><i class="fa fa-check"></i>3.2. Anàlisi de l’expressió gènica en individus curats al llarg del temps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html"><i class="fa fa-check"></i>Pràctica 7. Models de Regressió lineal (I)</a>
<ul>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#objectius-de-la-pràctica-4"><i class="fa fa-check"></i>Objectius de la pràctica</a></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#importar-dades-a-r-5"><i class="fa fa-check"></i>1. Importar dades a R</a></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#model-de-regressió-lineal-simple"><i class="fa fa-check"></i>2. Model de regressió lineal simple</a>
<ul>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#selecció-de-mostres-per-lanàlisi-8"><i class="fa fa-check"></i>2.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#predicció-dels-nivells-de-xpert-en-funció-de-lexpressió-gènica"><i class="fa fa-check"></i>2.2. Predicció dels nivells de Xpert en funció de l’expressió gènica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#model-de-regressió-lineal-múltiple"><i class="fa fa-check"></i>3. Model de regressió lineal múltiple</a>
<ul>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#selecció-de-mostres-per-lanàlisi-9"><i class="fa fa-check"></i>3.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#predicció-dels-nivells-de-xpert-en-funció-de-lexpressió-gènica-i-ledat"><i class="fa fa-check"></i>3.2. Predicció dels nivells de Xpert en funció de l’expressió gènica i l’edat</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#model-de-regressió-lineal-múltipleii"><i class="fa fa-check"></i>4. Model de regressió lineal múltiple(II)</a>
<ul>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#selecció-de-mostres-per-lanàlisi-10"><i class="fa fa-check"></i>4.1. Selecció de mostres per l’anàlisi</a></li>
<li class="chapter" data-level="" data-path="07-pract7-reglinealI.html"><a href="07-pract7-reglinealI.html#predicció-dels-nivells-de-xpert-en-funció-de-lexpressió-gènica-de-dos-gens"><i class="fa fa-check"></i>4.2. Predicció dels nivells de Xpert en funció de l’expressió gènica de dos gens</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="08-pract8-reglinealII.html"><a href="08-pract8-reglinealII.html"><i class="fa fa-check"></i>Pràctica 8. Models de Regressió lineal (II)</a>
<ul>
<li class="chapter" data-level="" data-path="08-pract8-reglinealII.html"><a href="08-pract8-reglinealII.html#objectius-2"><i class="fa fa-check"></i>Objectius</a></li>
<li class="chapter" data-level="" data-path="08-pract8-reglinealII.html"><a href="08-pract8-reglinealII.html#descripció-de-la-pràctica-1"><i class="fa fa-check"></i>Descripció de la pràctica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="09-pract9-reglogisticaI.html"><a href="09-pract9-reglogisticaI.html"><i class="fa fa-check"></i>Pràctica 9. Models de Regressió logística (I)</a>
<ul>
<li class="chapter" data-level="" data-path="09-pract9-reglogisticaI.html"><a href="09-pract9-reglogisticaI.html#objectius-3"><i class="fa fa-check"></i>Objectius</a></li>
<li class="chapter" data-level="" data-path="09-pract9-reglogisticaI.html"><a href="09-pract9-reglogisticaI.html#descripció-de-la-pràctica-2"><i class="fa fa-check"></i>Descripció de la pràctica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="10-pract10-reglogisticaII.html"><a href="10-pract10-reglogisticaII.html"><i class="fa fa-check"></i>Pràctica 10. Models de Regressió logística (II)</a>
<ul>
<li class="chapter" data-level="" data-path="10-pract10-reglogisticaII.html"><a href="10-pract10-reglogisticaII.html#objectius-4"><i class="fa fa-check"></i>Objectius</a></li>
<li class="chapter" data-level="" data-path="10-pract10-reglogisticaII.html"><a href="10-pract10-reglogisticaII.html#descripció-de-la-pràctica-3"><i class="fa fa-check"></i>Descripció de la pràctica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-pract11-visualitzacio.html"><a href="11-pract11-visualitzacio.html"><i class="fa fa-check"></i>Pràctica 11. Visualització i interpretació de resultats de seqüenciació</a>
<ul>
<li class="chapter" data-level="" data-path="11-pract11-visualitzacio.html"><a href="11-pract11-visualitzacio.html#objectius-5"><i class="fa fa-check"></i>Objectius</a></li>
<li class="chapter" data-level="" data-path="11-pract11-visualitzacio.html"><a href="11-pract11-visualitzacio.html#descripció-de-la-pràctica-4"><i class="fa fa-check"></i>Descripció de la pràctica</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pràctiques per l’anàlisi de dades òmiques amb R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pràctica-4.-testos-digualtat-de-mitjanes-per-més-de-dues-poblacions-anova-de-dos-factors-i-anova-per-mesures-repetides" class="section level1 hasAnchor">
<h1>Pràctica 4. Testos d’igualtat de mitjanes per més de dues poblacions: ANOVA de dos factors i ANOVA per mesures repetides<a href="04-pract4-anovaII.html#pràctica-4.-testos-digualtat-de-mitjanes-per-més-de-dues-poblacions-anova-de-dos-factors-i-anova-per-mesures-repetides" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="objectius-de-la-pràctica-1" class="section level2 hasAnchor">
<h2>Objectius de la pràctica<a href="04-pract4-anovaII.html#objectius-de-la-pràctica-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Els objectius principals de la pràctica són:</p>
<ul>
<li><p>Manipulació de data.frames (filtrar files segons diferents criteris)</p></li>
<li><p>Aplicar testos de comparació de mitjanes per més de dues poblacions (ANOVA) en funció de dos factors</p></li>
<li><p>Anàlisi de l’expressió longitudinal d’un gen en més de dos temps</p></li>
<li><p>Comprovar els supòsits de normalitat i homocedasticitat</p></li>
<li><p>Compendre les hipòtesis estadístiques associades a aquests testos i prendre decisions a partir dels seus resultats</p></li>
<li><p>Visualitzar de manera adequada dades en contextos de dissenys longitudinals</p></li>
<li><p>Relacionar les hipòtesis científiques plantejades inicialment amb els resultats estadístics</p></li>
</ul>
<p><br></p>
</div>
<div id="importar-dades-a-r-2" class="section level2 hasAnchor">
<h2>1. Importar dades a R<a href="04-pract4-anovaII.html#importar-dades-a-r-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Crea un nou RMarkdown anomenat “Practica4” i guarda’l a la carpeta de Pràctiques.
</p>
</div>
<ul>
<li>Crea un nou <em>chunk</em> que inclogui les diferents llibreries que
utilitzarem durant la pràctica:</li>
</ul>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="04-pract4-anovaII.html#cb68-1" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb68-2"><a href="04-pract4-anovaII.html#cb68-2" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<ul>
<li>En un altre <em>chunk</em> defineix el teu directori de treball i carrega
les dades (metadades: <em>practR_metadades.csv</em> i abundàncies de gens (filtrat): <em>practR_rnadata_filt.csv</em>)</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="04-pract4-anovaII.html#cb69-1" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;path/to/your/folder/with/data&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="04-pract4-anovaII.html#cb70-1" tabindex="-1"></a><span class="co"># carregar dades</span></span>
<span id="cb70-2"><a href="04-pract4-anovaII.html#cb70-2" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;dades/practR_metadades.csv&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb70-3"><a href="04-pract4-anovaII.html#cb70-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;dades/practR_rnadata_filt.csv&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li><p>Combina en un sol data.frame les dues matrius de dades (anomena’l <code>df</code>):</p></li>
<li><p>Fes les transformacions necessàries:</p></li>
</ul>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Guarda el data.frame <code>df</code> a la carpeta de dades amb el nom de
<em>“practR_dades.csv”</em> (busca a les pràctiques anteriors com <strong>exportar</strong>
fitxers de R a l’ordinador). D’aquesta manera només caldrà carregar
un sol fitxer per les properes pràctiques.
</p>
</div>
<p><br></p>
</div>
<div id="comparació-de-lexpressió-gènica-en-funció-de-dos-factors" class="section level2 hasAnchor">
<h2>2. Comparació de l’expressió gènica en funció de dos factors<a href="04-pract4-anovaII.html#comparació-de-lexpressió-gènica-en-funció-de-dos-factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="research-question-box">
<div class="rq-title">
Pregunta de recerca
</div>
<p>
L’expressió del gen 38 es pot veure afectada per la pròpia resposta al tractament (es curen/no es curen) i/o el sexe (home/dona) dels pacients?
</p>
</div>
<p>Per poder resoldre la pregunta de recerca, caldrà comprovar si hi ha diferències significatives en l’expressió del Gen 38 entre les dues poblacions de <strong>Curats</strong> vs <strong>No Curats</strong> a <strong>temps basal</strong>, tenint en compte el seu <strong>sexe</strong>.</p>
<div id="selecció-de-mostres-per-lanàlisi" class="section level3 hasAnchor">
<h3>2.1. Selecció de mostres per l’anàlisi<a href="04-pract4-anovaII.html#selecció-de-mostres-per-lanàlisi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Crea un nou data.frame (<code>df0</code>) només amb mostres d’expressió dels
gens a temps basal.</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="04-pract4-anovaII.html#cb71-1" tabindex="-1"></a>df0 <span class="ot">&lt;-</span> df[<span class="fu">which</span>(df<span class="sc">$</span>Temps <span class="sc">==</span> <span class="st">&quot;basal&quot;</span>),]</span></code></pre></div>
<ul>
<li>Ara crea un altre data.frame (<code>df1</code>), a partir de <code>df0</code> que inclogui
només mostres de pacients amb TB curats i no curats.</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="04-pract4-anovaII.html#cb72-1" tabindex="-1"></a>ind_0_c_nc <span class="ot">&lt;-</span> <span class="fu">which</span>(df0<span class="sc">$</span>Tractament <span class="sc">==</span> <span class="st">&quot;curat&quot;</span> <span class="sc">|</span> df0<span class="sc">$</span>Tractament <span class="sc">==</span> <span class="st">&quot;no curat&quot;</span> )</span>
<span id="cb72-2"><a href="04-pract4-anovaII.html#cb72-2" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df0[ind_0_c_nc,]</span></code></pre></div>
<ul>
<li>Re-defineix el factor <code>Tractament</code> i <code>Individu</code> (ho fem perquè
sàpiga que ara ja no tenim 3 categories de Tractament, sinó que n’hi
ha dues: curat i no curat. Igualment pel factor Individu)</li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="04-pract4-anovaII.html#cb73-1" tabindex="-1"></a>df1<span class="sc">$</span>Tractament <span class="ot">&lt;-</span> <span class="fu">factor</span>(df1<span class="sc">$</span>Tractament)</span>
<span id="cb73-2"><a href="04-pract4-anovaII.html#cb73-2" tabindex="-1"></a>df1<span class="sc">$</span>Individu <span class="ot">&lt;-</span> <span class="fu">factor</span>(df1<span class="sc">$</span>Individu)</span></code></pre></div>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Abans de continuar, observa les dades i comprova que has seleccionat
les mostres desitjades.
</p>
</div>
<p><br></p>
</div>
<div id="efecte-de-la-resposta-al-tractament-i-del-sexe-sobre-lexpressió-gènica" class="section level3 hasAnchor">
<h3>2.2. Efecte de la resposta al tractament i del sexe sobre l’expressió gènica<a href="04-pract4-anovaII.html#efecte-de-la-resposta-al-tractament-i-del-sexe-sobre-lexpressió-gènica" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es vol determinar si l’expressió basal (abans de començar el tractament)
del gen 38 es veu efectat pel fet de que el pacient amb TB sigui home o
dona, i/o la seva reacció al tractament (si s’acaba curant o no).</p>
<div id="exploració-de-les-dades-2" class="section level4 hasAnchor">
<h4>Exploració de les dades<a href="04-pract4-anovaII.html#exploració-de-les-dades-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Fes un resum (gràfic i numèric) de l’expressió del gen 38 en funció
de la resposta al tractament</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="04-pract4-anovaII.html#cb74-1" tabindex="-1"></a><span class="co"># Resum numèric (ex: mitjana de cada grup):</span></span>
<span id="cb74-2"><a href="04-pract4-anovaII.html#cb74-2" tabindex="-1"></a><span class="fu">tapply</span>(df1<span class="sc">$</span>Gen_38, df1<span class="sc">$</span>Tractament, mean)</span></code></pre></div>
<pre><code>##    curat no curat 
## 49.08267 50.54300</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="04-pract4-anovaII.html#cb76-1" tabindex="-1"></a><span class="co"># gràfic</span></span>
<span id="cb76-2"><a href="04-pract4-anovaII.html#cb76-2" tabindex="-1"></a><span class="fu">ggboxplot</span>(<span class="at">data =</span> df1, <span class="at">x =</span> <span class="st">&quot;Tractament&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Gen_38&quot;</span>,</span>
<span id="cb76-3"><a href="04-pract4-anovaII.html#cb76-3" tabindex="-1"></a>       <span class="at">add =</span> <span class="st">&quot;jitter&quot;</span>) <span class="co"># fixa&#39;t que aquest argument afegeix al gràfic cada una de les mostres (punts)</span></span></code></pre></div>
<p><img src="Practiques_R_Bioinformatica_I_files/figure-html/unnamed-chunk-58-1.png" alt="" width="672" /></p>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Fes un resum (gràfic i numèric) de l’expressió del gel 38 en funció
del sexe
</p>
</div>
<ul>
<li>Fes un resum (gràfic i numèric) de l’expressió del gel 38 en funció
del sexe i de la resposta al tractament</li>
</ul>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="04-pract4-anovaII.html#cb77-1" tabindex="-1"></a><span class="co"># Resum numèric (ex: mitjana de cada grup):</span></span>
<span id="cb77-2"><a href="04-pract4-anovaII.html#cb77-2" tabindex="-1"></a><span class="fu">tapply</span>(df1<span class="sc">$</span>Gen_38, <span class="fu">list</span>(df1<span class="sc">$</span>Tractament,df1<span class="sc">$</span>Sexe), mean)</span></code></pre></div>
<pre><code>##                 F        M
## curat    49.42632 48.48909
## no curat 49.90786 51.09875</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="04-pract4-anovaII.html#cb79-1" tabindex="-1"></a><span class="co"># Gràfic</span></span>
<span id="cb79-2"><a href="04-pract4-anovaII.html#cb79-2" tabindex="-1"></a><span class="fu">ggboxplot</span>(<span class="at">data =</span> df1, <span class="at">x =</span> <span class="st">&quot;Tractament&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Gen_38&quot;</span>,</span>
<span id="cb79-3"><a href="04-pract4-anovaII.html#cb79-3" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;Sexe&quot;</span>,</span>
<span id="cb79-4"><a href="04-pract4-anovaII.html#cb79-4" tabindex="-1"></a>       <span class="at">add =</span> <span class="st">&quot;jitter&quot;</span>)</span></code></pre></div>
<p><img src="Practiques_R_Bioinformatica_I_files/figure-html/unnamed-chunk-59-1.png" alt="" width="672" /></p>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta els gràfics i explica quin resultat esperaries.
</p>
</div>
</div>
<div id="anàlisi-estadística-2" class="section level4 hasAnchor">
<h4>Anàlisi estadística<a href="04-pract4-anovaII.html#anàlisi-estadística-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Per analitzar l’efecte de dos factors (<em>e.g.</em>, resposta al tractament i
sexe) sobre una variable numèrica (<em>e.g.</em>, expressió del gen 38) s’ha de
realitzar una <strong>ANOVA de dos factors</strong>.</p>
<p>Les hipòtesis de l’ANOVA de dos factors són:</p>
<ol style="list-style-type: decimal">
<li>Pel que fa a la resposta al tractament (1r factor):</li>
</ol>
<p><span class="math display">\[H_0: \mu_{curat} = \mu_{no.curat}\]</span>
<span class="math display">\[H_a: \mu_{curat} \neq \mu_{no.curat}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Pel que fa al sexe (2n factor):</li>
</ol>
<p><span class="math display">\[H_0: \mu_{homes} = \mu_{dones}\]</span>
<span class="math display">\[H_a: \mu_{homes} \neq \mu_{dones}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Pel que fa a la interacció entre la resposta i el sexe:</li>
</ol>
<p><span class="math display">\[H_0: \text{no hi ha interacció entre el fet de curar-se (o no) i el sexe}\]</span>
<span class="math display">\[H_a: \text{hi ha interacció entre el fet de curar-se (o no) i el sexe}\]</span></p>
<p><br></p>
<p><strong>1r.</strong> Abans d’aplicar l’ANOVA cal <strong>comprovar els supòsits</strong>:</p>
<ol style="list-style-type: upper-roman">
<li>Comprovar que totes mostres provenen de poblacions amb <em>distribució normal</em> (es comprova mitjançant el test de shapiro: <code>shapiro.test()</code>).</li>
</ol>
<ul>
<li>Comprova la normalitat dins de cada grup (<em>e.g.</em>, no curat-dona; no
curat-home; curat-dona; curat-home).</li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="04-pract4-anovaII.html#cb80-1" tabindex="-1"></a><span class="co"># shapiro test</span></span>
<span id="cb80-2"><a href="04-pract4-anovaII.html#cb80-2" tabindex="-1"></a>shaptest <span class="ot">&lt;-</span> <span class="fu">tapply</span>(df1<span class="sc">$</span>Gen_38, <span class="fu">list</span>(df1<span class="sc">$</span>Tractament,df1<span class="sc">$</span>Sexe), shapiro.test)</span>
<span id="cb80-3"><a href="04-pract4-anovaII.html#cb80-3" tabindex="-1"></a>shaptest</span></code></pre></div>
<pre><code>##          F       M      
## curat    htest,4 htest,4
## no curat htest,4 htest,4</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="04-pract4-anovaII.html#cb82-1" tabindex="-1"></a><span class="co"># Accedim als resultats del test dins de cada grup</span></span>
<span id="cb82-2"><a href="04-pract4-anovaII.html#cb82-2" tabindex="-1"></a>shaptest[<span class="dv">1</span>,<span class="dv">1</span>]  <span class="co"># curat - F</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.95623, p-value = 0.5007</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="04-pract4-anovaII.html#cb84-1" tabindex="-1"></a>shaptest[<span class="dv">1</span>,<span class="dv">2</span>]  <span class="co"># curat - M</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.92625, p-value = 0.3742</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="04-pract4-anovaII.html#cb86-1" tabindex="-1"></a>shaptest[<span class="dv">2</span>,<span class="dv">1</span>]  <span class="co"># no curat - F</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.98672, p-value = 0.9971</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="04-pract4-anovaII.html#cb88-1" tabindex="-1"></a>shaptest[<span class="dv">2</span>,<span class="dv">2</span>]  <span class="co"># no curat - M</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.97266, p-value = 0.8796</code></pre>
<ul>
<li>Visualitza amb un QQ plot la normalitat de les dades (fes-ho amb la
funció <code>ggqqplot()</code>). Les dades (de cada grup) s’ajusten a la línia?</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="04-pract4-anovaII.html#cb90-1" tabindex="-1"></a><span class="fu">ggqqplot</span>(df1, <span class="at">x =</span> <span class="st">&quot;Gen_38&quot;</span>, </span>
<span id="cb90-2"><a href="04-pract4-anovaII.html#cb90-2" tabindex="-1"></a>         <span class="at">facet.by =</span> <span class="fu">c</span>(<span class="st">&quot;Tractament&quot;</span>,<span class="st">&quot;Sexe&quot;</span>),</span>
<span id="cb90-3"><a href="04-pract4-anovaII.html#cb90-3" tabindex="-1"></a>         <span class="at">short.panel.labs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="Practiques_R_Bioinformatica_I_files/figure-html/unnamed-chunk-61-1.png" alt="" width="672" /></p>
<p><br></p>
<ol start="2" style="list-style-type: upper-roman">
<li>Conèixer si les variàncies dels grups segueixen l’<em>homocedasticitat</em> (es comprova mitjançant el test de Levene: <code>leveneTest()</code>). Per aplicar la funció <code>leveneTest()</code> hauràs de carregar la llibreria <code>car</code> (ho hauries d’haver fet al principi, al primer <em>chunk</em>).</li>
</ol>
<ul>
<li>Comprova l’homocedasticitat amb la funció <code>leveneTest()</code></li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="04-pract4-anovaII.html#cb91-1" tabindex="-1"></a><span class="fu">leveneTest</span>(df1<span class="sc">$</span>Gen_38 <span class="sc">~</span> df1<span class="sc">$</span>Tractament<span class="sc">*</span>df1<span class="sc">$</span>Sexe)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  3  0.2591 0.8545
##       56</code></pre>
<ol start="3" style="list-style-type: upper-roman">
<li>Identificar que les dades són <em>independents</em></li>
</ol>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta el resultat dels tests estadístics referents als supòsits i escriu un resum/conclusions pel que fa als supòsits de normalitat, homocedasticitat i independència de les dades.
</p>
</div>
<p><br></p>
<p><strong>2n.</strong> Si es compleixen els tres supòsits es pot aplicar l’<strong>ANOVA</strong>:</p>
<ul>
<li>Realitza l’anova de dos factors. Fixa’t en les diferències respecte l’anova d’un sol factor (Pràctica 3).</li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="04-pract4-anovaII.html#cb93-1" tabindex="-1"></a><span class="co"># test anova</span></span>
<span id="cb93-2"><a href="04-pract4-anovaII.html#cb93-2" tabindex="-1"></a>an1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(df1<span class="sc">$</span>Gen_38 <span class="sc">~</span> df1<span class="sc">$</span>Tractament <span class="sc">*</span> df1<span class="sc">$</span>Sexe)</span>
<span id="cb93-3"><a href="04-pract4-anovaII.html#cb93-3" tabindex="-1"></a></span>
<span id="cb93-4"><a href="04-pract4-anovaII.html#cb93-4" tabindex="-1"></a><span class="co"># resultats de l&#39;anova</span></span>
<span id="cb93-5"><a href="04-pract4-anovaII.html#cb93-5" tabindex="-1"></a><span class="fu">summary</span>(an1)</span></code></pre></div>
<pre><code>##                         Df Sum Sq Mean Sq F value Pr(&gt;F)
## df1$Tractament           1   32.0   31.99   1.083  0.303
## df1$Sexe                 1    0.4    0.39   0.013  0.909
## df1$Tractament:df1$Sexe  1   16.3   16.32   0.552  0.460
## Residuals               56 1654.4   29.54</code></pre>
<ul>
<li>Comprova la normalitat dels residus de l’anova</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="04-pract4-anovaII.html#cb95-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(an1<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  an1$residuals
## W = 0.9805, p-value = 0.4503</code></pre>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta el resultat del test estadístic i escriu una petita conclusió referent a la pregunta de recerca.
</p>
</div>
<p><br></p>
</div>
</div>
</div>
<div id="comparació-de-lexpressió-al-llarg-del-temps" class="section level2 hasAnchor">
<h2>3. Comparació de l’expressió al llarg del temps<a href="04-pract4-anovaII.html#comparació-de-lexpressió-al-llarg-del-temps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="research-question-box">
<div class="rq-title">
Pregunta de recerca
</div>
<p>
L’expressió del gen 38 dels individus que s’acaben curant varia al llarg del temps?
</p>
</div>
<p>En aquest cas ens centrarem en l’expressió del <strong>gen 38</strong> al llarg del <strong>temps</strong> dels
individus que s’acaben <strong>curant</strong>.</p>
<p>Per realitzar aquest anàlisi hem de tenir en compte que estem davant
d’un disseny experimental de <strong>mesures repetides</strong> (o disseny longitudinal).
Això implica que les dades dels diferents grups (Temps) no són
completament independents, de fet, l’expressió del gen en temps
posteriors en un individu dependrà segurament de l’expressió en temps
anteriors d’aquest mateix individu.</p>
<div id="selecció-de-mostres-per-lanàlisi-1" class="section level3 hasAnchor">
<h3>3.1. Selecció de mostres per l’anàlisi<a href="04-pract4-anovaII.html#selecció-de-mostres-per-lanàlisi-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Crea un nou data.frame (<code>df2</code>) que contingui totes les mostres a
diferent temps només dels individus curats. Comprova que <code>df2</code> inclogui
les mostres desitjades.
</p>
</div>
<ul>
<li>Re-defineix el factor <code>Tractament</code> i <code>Individu</code> (ho fem perquè
sàpiga que ara ja no tenim 3 categories de Tractament, sinó que n’hi
ha només una, curat. Fem el mateix pel factor Individu)</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="04-pract4-anovaII.html#cb97-1" tabindex="-1"></a>df2<span class="sc">$</span>Tractament <span class="ot">&lt;-</span> <span class="fu">factor</span>(df2<span class="sc">$</span>Tractament)</span>
<span id="cb97-2"><a href="04-pract4-anovaII.html#cb97-2" tabindex="-1"></a>df2<span class="sc">$</span>Individu <span class="ot">&lt;-</span> <span class="fu">factor</span>(df2<span class="sc">$</span>Individu)</span></code></pre></div>
</div>
<div id="expressió-del-gen-38-al-llarg-del-temps" class="section level3 hasAnchor">
<h3>3.2. Expressió del gen 38 al llarg del temps<a href="04-pract4-anovaII.html#expressió-del-gen-38-al-llarg-del-temps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="exploració-de-les-dades-3" class="section level4 hasAnchor">
<h4>Exploració de les dades<a href="04-pract4-anovaII.html#exploració-de-les-dades-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Representa gràficament l’expressió del gen 38 al llarg del temps
dels pacients que s’acaben curant. Com es diu aquest gràfic?</li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="04-pract4-anovaII.html#cb98-1" tabindex="-1"></a><span class="fu">ggline</span>(<span class="at">data =</span> df2, <span class="at">x =</span> <span class="st">&quot;Temps&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Gen_38&quot;</span>,</span>
<span id="cb98-2"><a href="04-pract4-anovaII.html#cb98-2" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Individu&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was
## deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## ℹ The deprecated feature was likely used in
##   the ggpubr package.
##   Please report the issue at
##   &lt;https://github.com/kassambara/ggpubr/issues&gt;.
## This warning is displayed once per session.
## Call `lifecycle::last_lifecycle_warnings()` to
## see where this warning was generated.</code></pre>
<p><img src="Practiques_R_Bioinformatica_I_files/figure-html/unnamed-chunk-67-1.png" alt="" width="672" /></p>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Descriu el gràfic anterior i digues quins poden ser els resultats
esperats
</p>
</div>
<p><br></p>
</div>
<div id="anàlisi-estadística-3" class="section level4 hasAnchor">
<h4>Anàlisi estadística<a href="04-pract4-anovaII.html#anàlisi-estadística-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En aquest cas, al tractar-se de mesures repetides s’haurà d’aplicar un
<strong>ANOVA per disseny de mesures repetides</strong>.</p>
<p>Les hipòtesis de l’ANOVA per mesures repetides:</p>
<p><span class="math display">\[\small{H_0: \text{les mitjanes poblacionals d&#39;expressió del gen son iguals en tots els temps}}\]</span>
<span class="math display">\[\small{H_a: \text{les mitjanes poblacionals d&#39;expressió del gen són diferent en almenys un dels temps mesurats}}\]</span></p>
<p><br></p>
<p><strong>1r.</strong> Abans d’aplicar l’ANOVA cal <strong>comprovar els supòsits</strong>:</p>
<ol style="list-style-type: upper-roman">
<li>Comprovar que totes mostres/gurps provenen de poblacions amb <em>distribució normal</em> (es comprova mitjançant el test de shapiro: <code>shapiro.test()</code>).</li>
</ol>
<ul>
<li>Abans però, digues quantes dades hi ha dins de
cada grup (per <code>$Temps</code> i <code>$Individu</code>)?</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="04-pract4-anovaII.html#cb100-1" tabindex="-1"></a><span class="fu">table</span>(df2<span class="sc">$</span>Temps, df2<span class="sc">$</span>Individu)</span></code></pre></div>
<pre><code>##        
##         31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54
##   basal  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##   1set   1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##   4set   1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##   24set  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##        
##         55 56 57 58 59 60
##   basal  1  1  1  1  1  1
##   1set   1  1  1  1  1  1
##   4set   1  1  1  1  1  1
##   24set  1  1  1  1  1  1</code></pre>
<ul>
<li>Com has pogut comprovar, en aquest cas hi ha una sola mostra dins de
cada “grup”, per tant, comprovar la normalitat d’una sola mostra no
té sentit. La normalitat es comprovarà posteriorment a partir dels
residus de l’anova. Prova de fer córrer la següent línia (per
compilar l’Rmarkdown no la podràs incloure):</li>
</ul>
<pre><code>tapply(df2$Gen_38, list(df2$Temps,df2$Individu) , shapiro.test)</code></pre>
<ol start="2" style="list-style-type: upper-roman">
<li>Conèixer si les variàncies dels grups segueixen l’<em>homocedasticitat</em></li>
</ol>
<ul>
<li>Amb l’homocedastisitat passa el mateix. No podem avaluar
l’homocedasticitat d’una sola mostra mitjançant el test de Levene.
En aquest cas hi ha l’alternativa d’aplicar el test de Mauchly’s
Sphericity, però no ho farem. Prova de fer córrer la següent línia
(per compilar l’Rmarkdown no la podràs incloure):</li>
</ul>
<pre><code>leveneTest(df2$Gen_38~df2$Time*df2$Individu)</code></pre>
<ol start="3" style="list-style-type: upper-roman">
<li>En aquest cas, les mostres no són <em>independents</em></li>
</ol>
<p><br></p>
<p><strong>2n.</strong> Es pot aplicar l’<strong>ANOVA</strong> per mesures repetides en aquest cas:</p>
<ul>
<li>Realitza l’ANOVA per mesures repetides</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="04-pract4-anovaII.html#cb104-1" tabindex="-1"></a><span class="co"># test anova</span></span>
<span id="cb104-2"><a href="04-pract4-anovaII.html#cb104-2" tabindex="-1"></a>an2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(df2<span class="sc">$</span>Gen_38 <span class="sc">~</span> df2<span class="sc">$</span>Temps <span class="sc">+</span> df2<span class="sc">$</span>Individu)</span>
<span id="cb104-3"><a href="04-pract4-anovaII.html#cb104-3" tabindex="-1"></a></span>
<span id="cb104-4"><a href="04-pract4-anovaII.html#cb104-4" tabindex="-1"></a><span class="co"># resultats de l&#39;anova</span></span>
<span id="cb104-5"><a href="04-pract4-anovaII.html#cb104-5" tabindex="-1"></a><span class="fu">summary</span>(an2)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## df2$Temps     3   2769   922.9  44.180 &lt;2e-16 ***
## df2$Individu 29   1014    35.0   1.673 0.0353 *  
## Residuals    87   1817    20.9                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>Ara pots comprovar la normalitat dels residus de l’anova</li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="04-pract4-anovaII.html#cb106-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(an2<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  an2$residuals
## W = 0.98837, p-value = 0.4004</code></pre>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta el resultat dels tests estadístics referents als supòsits i escriu un resum/conclusions pel que fa als supòsits de normalitat i independència de les dades.
</p>
</div>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta el resultat de l’ANOVA per mesures repetides i relaciona-ho amb la pregunta de recerca.
</p>
</div>
<p><br></p>
<p><strong>3r.</strong> Només quan l’ANOVA surt significativa (almenys un dels grups és diferent de la resta), aplicarem <strong>proves de comparació múltiples</strong> per conèixer quin/quins grup/s difereixen entre si.</p>
<ul>
<li>Realitza la prova de Tukey per veure quin (o quins) temps difereix
de la resta. En quins p-valors ens hem de fixar?</li>
</ul>
<pre><code>TukeyHSD(an2)</code></pre>
<pre><code>##                   diff       lwr       upr        p adj
## 1set-basal  11.6853333  8.594194 14.776472 3.090427e-10
## 4set-basal  10.9900000  7.898861 14.081139 3.091019e-10
## 24set-basal 10.4690000  7.377861 13.560139 3.095371e-10
## 4set-1set   -0.6953333 -3.786472  2.395806 9.350916e-01
## 24set-1set  -1.2163333 -4.307472  1.874806 7.319546e-01
## 24set-4set  -0.5210000 -3.612139  2.570139 9.710773e-01</code></pre>
<pre><code>##          diff       lwr       upr     p adj
## 32-31  1.7100 -10.82208 14.242085 1.0000000
## 33-31  0.9525 -11.57958 13.484585 1.0000000
## 34-31 -3.2600 -15.79208  9.272085 0.9999999
## 35-31  0.6675 -11.86458 13.199585 1.0000000
## 36-31  0.7300 -11.80208 13.262085 1.0000000
## 37-31  1.8800 -10.65208 14.412085 1.0000000</code></pre>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta el resultat del test estadístic i relaciona-ho amb la pregunta de recerca. Ajuda’t del line plot creat a l’apartat d’exploració de les dades.
</p>
</div>
<p><br></p>
</div>
</div>
</div>
<div id="comparació-de-lexpressió-al-llarg-del-temps-i-en-funció-dun-factor" class="section level2 hasAnchor">
<h2>4. Comparació de l’expressió al llarg del temps i en funció d’un factor<a href="04-pract4-anovaII.html#comparació-de-lexpressió-al-llarg-del-temps-i-en-funció-dun-factor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="research-question-box">
<div class="rq-title">
Pregunta de recerca
</div>
<p>
Els pacients que es curen i els que no es curen tenen el mateix perfil d’expressió d’aquest gen al llarg del temps?
</p>
</div>
<div id="selecció-de-mostres-per-lanàlisi-2" class="section level3 hasAnchor">
<h3>4.1. Selecció de mostres per l’anàlisi<a href="04-pract4-anovaII.html#selecció-de-mostres-per-lanàlisi-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Crea un nou data.frame, <code>df3</code> que contingui les observacions a tots els temps dels individus curats i els no curats. Comprova que <code>df3</code> inclogui les mostres desitjades.
</p>
</div>
<ul>
<li>Re-defineix el factor <code>Tractament</code> i <code>Individu</code> (ho fem perquè
sàpiga que ara ja no tenim 3 categories de Tractament, sinó que n’hi
ha dues: curat i no curat. Igualment pel factor Individu)</li>
</ul>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="04-pract4-anovaII.html#cb111-1" tabindex="-1"></a>df3<span class="sc">$</span>Tractament <span class="ot">&lt;-</span> <span class="fu">factor</span>(df3<span class="sc">$</span>Tractament)</span>
<span id="cb111-2"><a href="04-pract4-anovaII.html#cb111-2" tabindex="-1"></a>df3<span class="sc">$</span>Individu <span class="ot">&lt;-</span> <span class="fu">factor</span>(df3<span class="sc">$</span>Individu)</span></code></pre></div>
</div>
<div id="expressió-del-gen-38-al-llarg-del-temps-en-curats-i-no-curats" class="section level3 hasAnchor">
<h3>4.2. Expressió del gen 38 al llarg del temps en curats i no curats<a href="04-pract4-anovaII.html#expressió-del-gen-38-al-llarg-del-temps-en-curats-i-no-curats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="exploració-de-les-dades-4" class="section level4 hasAnchor">
<h4>Exploració de les dades<a href="04-pract4-anovaII.html#exploració-de-les-dades-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Representa gràficament l’expressió del gen 38 al llarg del temps
distingint els pacients que s’acaben curant dels que no. Hi ha
diferents opcions per representar aquestes dades, una és aquesta:</li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="04-pract4-anovaII.html#cb112-1" tabindex="-1"></a><span class="fu">ggline</span>(<span class="at">data =</span> df3, <span class="at">x =</span> <span class="st">&quot;Temps&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Gen_38&quot;</span>, </span>
<span id="cb112-2"><a href="04-pract4-anovaII.html#cb112-2" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Tractament&quot;</span>,</span>
<span id="cb112-3"><a href="04-pract4-anovaII.html#cb112-3" tabindex="-1"></a>       <span class="at">add =</span> <span class="fu">c</span>(<span class="st">&quot;mean_se&quot;</span>, <span class="st">&quot;jitter&quot;</span>),</span>
<span id="cb112-4"><a href="04-pract4-anovaII.html#cb112-4" tabindex="-1"></a>       <span class="at">size =</span> .<span class="dv">75</span>,</span>
<span id="cb112-5"><a href="04-pract4-anovaII.html#cb112-5" tabindex="-1"></a>       <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span></code></pre></div>
<p><img src="Practiques_R_Bioinformatica_I_files/figure-html/unnamed-chunk-74-1.png" alt="" width="672" /></p>
<ul>
<li>Calcula la mitjana de l’expressió dins de cada grup:</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="04-pract4-anovaII.html#cb113-1" tabindex="-1"></a><span class="fu">tapply</span>(df3<span class="sc">$</span>Gen_38, <span class="fu">list</span>(df3<span class="sc">$</span>Temps,df3<span class="sc">$</span>Tractament), mean)</span></code></pre></div>
<pre><code>##          curat no curat
## basal 49.08267 50.54300
## 1set  60.76800 55.63267
## 4set  60.07267 45.72400
## 24set 59.55167 40.36200</code></pre>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Descriu el gràfic anterior i digues si esperes veure diferències al
llarg del temps entre els dos grups de pacients.
</p>
</div>
<p><br></p>
</div>
<div id="anàlisi-estadística-4" class="section level4 hasAnchor">
<h4>Anàlisi estadística<a href="04-pract4-anovaII.html#anàlisi-estadística-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Aques últim cas és un exemple de mesures repetides on, a més, es vol
veure l’efecte d’un segon factor (<em>i.e.</em>, resposta al tractament). Per
tant, s’haurà d’aplicar una <strong>ANOVA de dos factors per disseny de mesures repetides</strong>.</p>
<p>Similar a l’ANOVA de fos factors, en el cas de mesures repetides un dels
factors és el temps. Les hipòtesis del test són:</p>
<ol style="list-style-type: decimal">
<li>Pel que fa al temps:</li>
</ol>
<p><span class="math display">\[\small{H_0: \text{les mitjanes poblacionals d&#39;expressió del gen son constants al llarg del temps}}\]</span>
<span class="math display">\[\small{ H_a: \text{les mitjanes poblacionals d&#39;expressió canvien en almenys un dels temps mostrejats}}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Pel que fa a la resposta al tractament:</li>
</ol>
<p><span class="math display">\[\small{ H_0: \text{les mitjanes poblacionals d&#39;expressió del gen son iguals en pacients curats i no curats}}\]</span>
<span class="math display">\[\small{ H_a: \text{les mitjanes poblacionals d&#39;expressió en pacients curats i no curats són diferents}}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Pel que fa a la interacció entre la resposta i el temps:</li>
</ol>
<p><span class="math display">\[\small{ H_0: \text{no hi ha interacció entre el fet de curar-se (o no) i el temps}}\]</span>
<span class="math display">\[\small{H_a: \text{el temps té un efecte sobre la resposta al tractament}}\]</span></p>
<p><br></p>
<p><strong>1r.</strong> Abans d’aplicar l’ANOVA cal <strong>comprovar els supòsits</strong>:</p>
<ol style="list-style-type: upper-roman">
<li>Comprovar que totes mostres/gurps provenen de poblacions amb <em>distribució normal</em> (es comprova mitjançant el test de shapiro: <code>shapiro.test()</code>).</li>
</ol>
<ul>
<li>Abans de comprovar els supòsits, digues quantes dades hi ha dins de
cada grup (per <code>$Temps</code> i <code>$Tractament</code>)?</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="04-pract4-anovaII.html#cb115-1" tabindex="-1"></a><span class="fu">table</span>(df3<span class="sc">$</span>Temps, df3<span class="sc">$</span>Tractament)</span></code></pre></div>
<pre><code>##        
##         curat no curat
##   basal    30       30
##   1set     30       30
##   4set     30       30
##   24set    30       30</code></pre>
<ul>
<li>Comprova la normalitat amb un test de shapiro per cada grup
analitzat.</li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="04-pract4-anovaII.html#cb117-1" tabindex="-1"></a><span class="co"># shapiro test dins de cada grup</span></span>
<span id="cb117-2"><a href="04-pract4-anovaII.html#cb117-2" tabindex="-1"></a>shaptest2 <span class="ot">&lt;-</span> <span class="fu">tapply</span>(df3<span class="sc">$</span>Gen_38, <span class="fu">list</span>(df3<span class="sc">$</span>Temps,df3<span class="sc">$</span>Tractament) , shapiro.test)</span>
<span id="cb117-3"><a href="04-pract4-anovaII.html#cb117-3" tabindex="-1"></a>shaptest2</span></code></pre></div>
<pre><code>##       curat   no curat
## basal htest,4 htest,4 
## 1set  htest,4 htest,4 
## 4set  htest,4 htest,4 
## 24set htest,4 htest,4</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="04-pract4-anovaII.html#cb119-1" tabindex="-1"></a><span class="co"># extreiem els resultats del test de cada grup</span></span>
<span id="cb119-2"><a href="04-pract4-anovaII.html#cb119-2" tabindex="-1"></a>shaptest2[<span class="dv">1</span>,<span class="dv">1</span>]  <span class="co"># basal - curat</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.95624, p-value = 0.2475</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="04-pract4-anovaII.html#cb121-1" tabindex="-1"></a>shaptest2[<span class="dv">1</span>,<span class="dv">2</span>]  <span class="co"># basal - no curat</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.98465, p-value = 0.9311</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="04-pract4-anovaII.html#cb123-1" tabindex="-1"></a>shaptest2[<span class="dv">2</span>,<span class="dv">1</span>]  <span class="co"># 1 set - curat</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.909, p-value = 0.01404</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="04-pract4-anovaII.html#cb125-1" tabindex="-1"></a>shaptest2[<span class="dv">2</span>,<span class="dv">2</span>]  <span class="co"># 1 set - no curat</span></span></code></pre></div>
<pre><code>## [[1]]
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.93079, p-value = 0.05154</code></pre>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Mostra la resta de resultats del test de shapiro (4set - curat;
4set - no curat; 24set - curat; 4set - no curat)
</p>
</div>
<ul>
<li>Visualitza amb un QQ plot la normalitat de les dades (fes-ho amb la
funció <code>ggqqplot()</code>). Comenta els resultats del test i del QQ-plot.</li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="04-pract4-anovaII.html#cb127-1" tabindex="-1"></a><span class="fu">ggqqplot</span>(df3, <span class="at">x =</span> <span class="st">&quot;Gen_38&quot;</span>, </span>
<span id="cb127-2"><a href="04-pract4-anovaII.html#cb127-2" tabindex="-1"></a>         <span class="at">facet.by =</span> <span class="fu">c</span>(<span class="st">&quot;Temps&quot;</span>,<span class="st">&quot;Tractament&quot;</span>),</span>
<span id="cb127-3"><a href="04-pract4-anovaII.html#cb127-3" tabindex="-1"></a>         <span class="at">short.panel.labs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="Practiques_R_Bioinformatica_I_files/figure-html/unnamed-chunk-78-1.png" alt="" width="672" /></p>
<ol start="2" style="list-style-type: upper-roman">
<li>Conèixer si les variàncies dels grups segueixen l’<em>homocedasticitat</em></li>
</ol>
<ul>
<li>Comprova ara la homogeneïtat de variàncies entre tots els grups.
Comenta els resultats.</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="04-pract4-anovaII.html#cb128-1" tabindex="-1"></a><span class="fu">leveneTest</span>(df3<span class="sc">$</span>Gen_38<span class="sc">~</span>df3<span class="sc">$</span>Temps<span class="sc">*</span>df3<span class="sc">$</span>Tractament)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value Pr(&gt;F)
## group   7  0.3973 0.9034
##       232</code></pre>
<ol start="3" style="list-style-type: upper-roman">
<li>En aquest cas, les mostres no són <em>independents</em></li>
</ol>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta el resultat dels tests estadístics referents als supòsits i escriu un resum/conclusions pel que fa als supòsits de normalitat, homocedasticitat i independència de les dades.
</p>
</div>
<p><br></p>
<p><strong>2n.</strong> Si es compleixen els supòsits es pot aplicar l’<strong>ANOVA</strong>:</p>
<ul>
<li>Realitza l’ANOVA de dos factors per mesures repetides (fixa’t en la sintaxi del codi)</li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="04-pract4-anovaII.html#cb130-1" tabindex="-1"></a><span class="co"># test anova</span></span>
<span id="cb130-2"><a href="04-pract4-anovaII.html#cb130-2" tabindex="-1"></a>an3 <span class="ot">&lt;-</span> <span class="fu">aov</span>(df3<span class="sc">$</span>Gen_38 <span class="sc">~</span> df3<span class="sc">$</span>Temps <span class="sc">*</span> df3<span class="sc">$</span>Tractament)</span>
<span id="cb130-3"><a href="04-pract4-anovaII.html#cb130-3" tabindex="-1"></a></span>
<span id="cb130-4"><a href="04-pract4-anovaII.html#cb130-4" tabindex="-1"></a><span class="co"># resultats de l&#39;anova</span></span>
<span id="cb130-5"><a href="04-pract4-anovaII.html#cb130-5" tabindex="-1"></a><span class="fu">summary</span>(an3)</span></code></pre></div>
<pre><code>##                           Df Sum Sq Mean Sq F value Pr(&gt;F)    
## df3$Temps                  3   2769     923   33.59 &lt;2e-16 ***
## df3$Tractament             1   5193    5193  189.00 &lt;2e-16 ***
## df3$Temps:df3$Tractament   3   3846    1282   46.66 &lt;2e-16 ***
## Residuals                232   6375      27                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>Ara pots comprovar la normalitat dels residus de l’ANOVA. Podriem
acabar acceptant els resultats d’aquesta ANOVA?</li>
</ul>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="04-pract4-anovaII.html#cb132-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(an3<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  an3$residuals
## W = 0.98627, p-value = 0.02091</code></pre>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta el resultat del test estadístic i relaciona-ho amb la pregunta de recerca.
</p>
</div>
<p><br></p>
<p><strong>3r.</strong> Només quan l’ANOVA surt significativa (almenys un dels grups és diferent de la resta), aplicarem <strong>proves de comparació múltiples</strong> per conèixer quin/quins grup/s difereixen entre si.</p>
<ul>
<li>Realitza la prova de Tukey per veure quin (o quins) dels grups
difereix de la resta. En quins p-valors ens hem de fixar?</li>
</ul>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="04-pract4-anovaII.html#cb134-1" tabindex="-1"></a><span class="fu">TukeyHSD</span>(an3)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = df3$Gen_38 ~ df3$Temps * df3$Tractament)
## 
## $`df3$Temps`
##                diff         lwr        upr     p adj
## 1set-basal   8.3875   5.9109465 10.8640535 0.0000000
## 4set-basal   3.0855   0.6089465  5.5620535 0.0078356
## 24set-basal  0.1440  -2.3325535  2.6205535 0.9987830
## 4set-1set   -5.3020  -7.7785535 -2.8254465 0.0000005
## 24set-1set  -8.2435 -10.7200535 -5.7669465 0.0000000
## 24set-4set  -2.9415  -5.4180535 -0.4649465 0.0125857
## 
## $`df3$Tractament`
##                     diff       lwr       upr p adj
## no curat-curat -9.303333 -10.63664 -7.970026     0
## 
## $`df3$Temps:df3$Tractament`
##                                      diff         lwr         upr     p adj
## 1set:curat-basal:curat         11.6853333   7.5453965  15.8252702 0.0000000
## 4set:curat-basal:curat         10.9900000   6.8500632  15.1299368 0.0000000
## 24set:curat-basal:curat        10.4690000   6.3290632  14.6089368 0.0000000
## basal:no curat-basal:curat      1.4603333  -2.6796035   5.6002702 0.9606228
## 1set:no curat-basal:curat       6.5500000   2.4100632  10.6899368 0.0000642
## 4set:no curat-basal:curat      -3.3586667  -7.4986035   0.7812702 0.2085880
## 24set:no curat-basal:curat     -8.7206667 -12.8606035  -4.5807298 0.0000000
## 4set:curat-1set:curat          -0.6953333  -4.8352702   3.4446035 0.9995853
## 24set:curat-1set:curat         -1.2163333  -5.3562702   2.9236035 0.9859588
## basal:no curat-1set:curat     -10.2250000 -14.3649368  -6.0850632 0.0000000
## 1set:no curat-1set:curat       -5.1353333  -9.2752702  -0.9953965 0.0046093
## 4set:no curat-1set:curat      -15.0440000 -19.1839368 -10.9040632 0.0000000
## 24set:no curat-1set:curat     -20.4060000 -24.5459368 -16.2660632 0.0000000
## 24set:curat-4set:curat         -0.5210000  -4.6609368   3.6189368 0.9999401
## basal:no curat-4set:curat      -9.5296667 -13.6696035  -5.3897298 0.0000000
## 1set:no curat-4set:curat       -4.4400000  -8.5799368  -0.3000632 0.0259204
## 4set:no curat-4set:curat      -14.3486667 -18.4886035 -10.2087298 0.0000000
## 24set:no curat-4set:curat     -19.7106667 -23.8506035 -15.5707298 0.0000000
## basal:no curat-24set:curat     -9.0086667 -13.1486035  -4.8687298 0.0000000
## 1set:no curat-24set:curat      -3.9190000  -8.0589368   0.2209368 0.0781646
## 4set:no curat-24set:curat     -13.8276667 -17.9676035  -9.6877298 0.0000000
## 24set:no curat-24set:curat    -19.1896667 -23.3296035 -15.0497298 0.0000000
## 1set:no curat-basal:no curat    5.0896667   0.9497298   9.2296035 0.0052056
## 4set:no curat-basal:no curat   -4.8190000  -8.9589368  -0.6790632 0.0104601
## 24set:no curat-basal:no curat -10.1810000 -14.3209368  -6.0410632 0.0000000
## 4set:no curat-1set:no curat    -9.9086667 -14.0486035  -5.7687298 0.0000000
## 24set:no curat-1set:no curat  -15.2706667 -19.4106035 -11.1307298 0.0000000
## 24set:no curat-4set:no curat   -5.3620000  -9.5019368  -1.2220632 0.0024797</code></pre>
<div class="task-box">
<div class="task-title">
Tasca
</div>
<p>
Interpreta els resultats i relaciona-ho amb les hipòtesis
plantejades a l’inici. Fixa’t sobretot en les interaccions no
significatives (p&gt;0.05) i ajuda’t del line plot, tenen sentit
aquests resultats?
</p>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="03-pract3-anovaI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="05-pract5-noparamI.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
